1
00:00:00,440 --> 00:00:03,679
okay well thanks for the intro and

2
00:00:01,640 --> 00:00:07,240
thanks for inviting me it's fun uh I'm

3
00:00:03,679 --> 00:00:09,360
Zach please um I hate talking at people

4
00:00:07,240 --> 00:00:12,360
so please you know like speak up and

5
00:00:09,360 --> 00:00:14,960
harass me uh and I guess I I decided to

6
00:00:12,360 --> 00:00:16,840
open this with like you know the most

7
00:00:14,960 --> 00:00:17,960
videos possible on a single slide I

8
00:00:16,840 --> 00:00:20,279
don't know if that was a good or bad

9
00:00:17,960 --> 00:00:22,320
idea it's like a shock and awe or

10
00:00:20,279 --> 00:00:24,680
something um but yeah hopefully I'll get

11
00:00:22,320 --> 00:00:25,960
to talk about most of these things um

12
00:00:24,680 --> 00:00:28,119
and I I think hopefully from this you

13
00:00:25,960 --> 00:00:30,560
can also glean that I'm like kind of uh

14
00:00:28,119 --> 00:00:33,360
my my two loves are like weird space

15
00:00:30,560 --> 00:00:35,920
things and uh and robots so that's what

16
00:00:33,360 --> 00:00:37,640
we're going to talk about um so first to

17
00:00:35,920 --> 00:00:39,840
open up uh and kind of set the stage a

18
00:00:37,640 --> 00:00:41,960
little bit uh hopefully everyone knows

19
00:00:39,840 --> 00:00:46,640
what this thing

20
00:00:41,960 --> 00:00:47,760
is H definitely not no we have some SP

21
00:00:46,640 --> 00:00:49,559
people in the room right so this is

22
00:00:47,760 --> 00:00:51,879
curiosity right and this thing has been

23
00:00:49,559 --> 00:00:53,000
on Mars for 12 years which is incredible

24
00:00:51,879 --> 00:00:54,359
if you think about it as like a feet of

25
00:00:53,000 --> 00:00:56,440
engineering right this thing's been in

26
00:00:54,359 --> 00:00:59,280
like one of the harshest environments

27
00:00:56,440 --> 00:01:00,719
imaginable uh you know storms crazy

28
00:00:59,280 --> 00:01:02,920
temperatures

29
00:01:00,719 --> 00:01:05,360
dust everywhere all that kind of stuff

30
00:01:02,920 --> 00:01:09,080
uh and in that time it's managed to

31
00:01:05,360 --> 00:01:11,799
travel 32 kilometers sounds pretty good

32
00:01:09,080 --> 00:01:13,720
until you divide those two numbers uh so

33
00:01:11,799 --> 00:01:15,360
like 7.2 meters per day roughly like you

34
00:01:13,720 --> 00:01:18,439
know here to the other side of the room

35
00:01:15,360 --> 00:01:20,479
over there this is not impressive and uh

36
00:01:18,439 --> 00:01:22,079
you know it's sort of a bummer and

37
00:01:20,479 --> 00:01:23,400
unfortunately it limits a lot of the

38
00:01:22,079 --> 00:01:24,799
science we can do on these things and

39
00:01:23,400 --> 00:01:27,040
there's a whole bunch of anecdotes about

40
00:01:24,799 --> 00:01:28,560
this um that I could share but um I

41
00:01:27,040 --> 00:01:30,840
think this kind of sums it up nicely

42
00:01:28,560 --> 00:01:33,159
does anyone know what this is

43
00:01:30,840 --> 00:01:37,560
who's been

44
00:01:33,159 --> 00:01:39,560
here maybe no okay so really letting me

45
00:01:37,560 --> 00:01:41,600
down on the on the space nerd uh you

46
00:01:39,560 --> 00:01:44,159
know stuff here so this is the Mars yard

47
00:01:41,600 --> 00:01:45,680
at JPL uh maybe a couple of You' have

48
00:01:44,159 --> 00:01:49,240
heard of this so basically what this is

49
00:01:45,680 --> 00:01:50,439
a giant sandbox out back at JPL where

50
00:01:49,240 --> 00:01:52,840
they have a bunch of rocks and a

51
00:01:50,439 --> 00:01:54,479
bulldozer and some shovels and they

52
00:01:52,840 --> 00:01:57,200
drive the Rover around so the Rover can

53
00:01:54,479 --> 00:01:58,880
drive autonomously it's pretty cool but

54
00:01:57,200 --> 00:02:00,479
um they're super conservative with it

55
00:01:58,880 --> 00:02:01,759
for obvious reasons right you can't fix

56
00:02:00,479 --> 00:02:05,360
stuff you can't go get it out of the

57
00:02:01,759 --> 00:02:07,399
ditch Etc and it's very expensive so um

58
00:02:05,360 --> 00:02:09,000
anytime it runs into anything scary

59
00:02:07,399 --> 00:02:11,800
looking like a slope more than a few

60
00:02:09,000 --> 00:02:13,959
degrees or a big rock it's uh set up to

61
00:02:11,800 --> 00:02:16,000
just stop and then like look around and

62
00:02:13,959 --> 00:02:18,480
send all the imagery back to Earth and

63
00:02:16,000 --> 00:02:21,360
all the JPL Engineers go out in this

64
00:02:18,480 --> 00:02:24,120
sandbox out back and try to recreate the

65
00:02:21,360 --> 00:02:26,120
environment around the Rover on Earth

66
00:02:24,120 --> 00:02:27,160
with a back hoe and a bunch of shovels

67
00:02:26,120 --> 00:02:28,519
and they kind of put the rocks in all

68
00:02:27,160 --> 00:02:30,239
the same places and then they

69
00:02:28,519 --> 00:02:33,160
painstakingly

70
00:02:30,239 --> 00:02:35,840
handd design a trajectory for the Rover

71
00:02:33,160 --> 00:02:38,040
to go around all the obstacles and test

72
00:02:35,840 --> 00:02:39,360
it a whole bunch and drive it with the

73
00:02:38,040 --> 00:02:40,879
real Rover and then when they're

74
00:02:39,360 --> 00:02:43,159
satisfied that that's going to work they

75
00:02:40,879 --> 00:02:45,080
Uplink it to the Rover and it and it

76
00:02:43,159 --> 00:02:47,080
executes it and then it goes on its way

77
00:02:45,080 --> 00:02:48,800
um this is as you know somewhat

78
00:02:47,080 --> 00:02:50,680
obviously super painstaking lots of

79
00:02:48,800 --> 00:02:51,920
human in the loop kind of stuff and

80
00:02:50,680 --> 00:02:54,000
ultimately limits what they can do with

81
00:02:51,920 --> 00:02:57,080
the Rover anecdotally if you talk to the

82
00:02:54,000 --> 00:02:59,519
the Rover drivers and stuff um if the

83
00:02:57,080 --> 00:03:01,440
Rover stops moving on a Saturday morning

84
00:02:59,519 --> 00:03:02,640
it'll be be stuck until Monday morning

85
00:03:01,440 --> 00:03:04,319
when everyone gets back in from the

86
00:03:02,640 --> 00:03:05,760
weekend if it happens over a holiday it

87
00:03:04,319 --> 00:03:08,360
just won't operate so you'll end up

88
00:03:05,760 --> 00:03:10,319
losing days of op operational time on

89
00:03:08,360 --> 00:03:12,080
this thing because of this kind of thing

90
00:03:10,319 --> 00:03:13,920
and it's sort of constrained by humans

91
00:03:12,080 --> 00:03:16,280
and you know we have to sleep and stuff

92
00:03:13,920 --> 00:03:18,360
eat occasionally so uh it it's actually

93
00:03:16,280 --> 00:03:20,799
a major major thing right okay and so

94
00:03:18,360 --> 00:03:23,200
where we like part one everything is

95
00:03:20,799 --> 00:03:25,280
optimization hopefully some of you agree

96
00:03:23,200 --> 00:03:26,720
with that statement we'll see um but I'm

97
00:03:25,280 --> 00:03:29,040
going to now kind of walk through a

98
00:03:26,720 --> 00:03:31,360
whole bunch of you know of the problems

99
00:03:29,040 --> 00:03:32,599
that we encounter in these sort of

100
00:03:31,360 --> 00:03:34,319
domains that hopefully all you guys have

101
00:03:32,599 --> 00:03:36,360
seen before and how each one of them at

102
00:03:34,319 --> 00:03:37,599
least can be posed as an optimization

103
00:03:36,360 --> 00:03:38,519
problem and in there I'm going to mix it

104
00:03:37,599 --> 00:03:39,840
up a little bit and show you some of the

105
00:03:38,519 --> 00:03:41,560
stuff that that we've done in each of

106
00:03:39,840 --> 00:03:42,920
these specific areas then we're going to

107
00:03:41,560 --> 00:03:44,280
try to bring it all together the first

108
00:03:42,920 --> 00:03:45,400
one you know obviously control is

109
00:03:44,280 --> 00:03:47,000
optimization I don't think I have to

110
00:03:45,400 --> 00:03:48,959
tell you guys in this audience this

111
00:03:47,000 --> 00:03:50,439
right and usually we kind of set things

112
00:03:48,959 --> 00:03:52,799
up like this and we have a model of our

113
00:03:50,439 --> 00:03:54,799
robot maybe or if you're an RL person

114
00:03:52,799 --> 00:03:56,640
maybe you have a blackbox simulator same

115
00:03:54,799 --> 00:03:58,799
thing whatever uh and then you have some

116
00:03:56,640 --> 00:04:00,519
kind of cost function thing that encodes

117
00:03:58,799 --> 00:04:02,000
what you want the system to do right and

118
00:04:00,519 --> 00:04:04,319
maybe some constraints that say you know

119
00:04:02,000 --> 00:04:06,640
your actuator limits and and don't hit

120
00:04:04,319 --> 00:04:08,200
stuff and whatever uh and this is very

121
00:04:06,640 --> 00:04:10,280
powerful and very general right and I I

122
00:04:08,200 --> 00:04:11,599
kind of in this I would I would sort of

123
00:04:10,280 --> 00:04:14,000
subsume all of you know kind of

124
00:04:11,599 --> 00:04:15,680
trajectory optimization and RL and all

125
00:04:14,000 --> 00:04:17,120
of these under this kind of framework

126
00:04:15,680 --> 00:04:18,799
right and just to tease a few of the

127
00:04:17,120 --> 00:04:20,560
things we've been doing in this area uh

128
00:04:18,799 --> 00:04:22,520
we worked a lot on numerical solvers and

129
00:04:20,560 --> 00:04:24,440
in the last year we've had kind of fun

130
00:04:22,520 --> 00:04:25,800
papers on getting these things to be

131
00:04:24,440 --> 00:04:27,639
really computationally efficient so they

132
00:04:25,800 --> 00:04:30,320
can fit on Tiny microcontrollers on

133
00:04:27,639 --> 00:04:31,919
stuff like this crazy fly um and do all

134
00:04:30,320 --> 00:04:34,520
kinds of fun obstacle avoidance and

135
00:04:31,919 --> 00:04:36,160
stuff uh all on board we've also kind of

136
00:04:34,520 --> 00:04:39,600
tried to scale these the other direction

137
00:04:36,160 --> 00:04:42,759
and build new solvers that can run on

138
00:04:39,600 --> 00:04:44,280
Modern compute Hardware like gpus right

139
00:04:42,759 --> 00:04:47,400
and actually take advantage of thousands

140
00:04:44,280 --> 00:04:49,240
of cores this is an example of of a full

141
00:04:47,400 --> 00:04:53,000
body model of the atlas humanoid running

142
00:04:49,240 --> 00:04:55,039
at 2 kerz kind of pretty good if you if

143
00:04:53,000 --> 00:04:57,680
you know how this stuff goes typically

144
00:04:55,039 --> 00:04:59,160
okay so that's you know control um also

145
00:04:57,680 --> 00:05:00,880
people in here I'm sure you know lots of

146
00:04:59,160 --> 00:05:03,560
people do state estimation this is

147
00:05:00,880 --> 00:05:05,160
almost the same problem it turns out um

148
00:05:03,560 --> 00:05:06,479
got your model maybe got some noise in

149
00:05:05,160 --> 00:05:07,960
there and then you've got some kind of

150
00:05:06,479 --> 00:05:09,639
lease squares loss or something that you

151
00:05:07,960 --> 00:05:11,520
minimize to figure out where you are

152
00:05:09,639 --> 00:05:13,720
we've also done some work in this area

153
00:05:11,520 --> 00:05:15,240
specifically um on the space side we've

154
00:05:13,720 --> 00:05:17,720
done a bunch of work on sort of

155
00:05:15,240 --> 00:05:19,479
satellite swarms and um doing kind of

156
00:05:17,720 --> 00:05:22,000
distributed estimation there's actually

157
00:05:19,479 --> 00:05:24,800
a mission we flew this year where we um

158
00:05:22,000 --> 00:05:26,120
did range only relative navigation uh

159
00:05:24,800 --> 00:05:29,160
between satellites and space and

160
00:05:26,120 --> 00:05:30,680
actually got down to 70 CM kind of 3D

161
00:05:29,160 --> 00:05:32,400
position are on this whole thing which

162
00:05:30,680 --> 00:05:35,840
was pretty awesome to actually do it

163
00:05:32,400 --> 00:05:37,400
finally in space um okay and then kind

164
00:05:35,840 --> 00:05:39,759
of moving away from from maybe some of

165
00:05:37,400 --> 00:05:40,960
the stuff that you've seen a lot of to

166
00:05:39,759 --> 00:05:43,319
maybe some stuff that's a little less

167
00:05:40,960 --> 00:05:44,840
familiar is um you can also pose physics

168
00:05:43,319 --> 00:05:47,360
as optimization anyone know what this

169
00:05:44,840 --> 00:05:49,039
thing is yeah so this is you know

170
00:05:47,360 --> 00:05:50,680
Hamilton's principle principle of least

171
00:05:49,039 --> 00:05:52,479
action sometimes people get really

172
00:05:50,680 --> 00:05:54,360
pedantic and tell me it's not least it's

173
00:05:52,479 --> 00:05:56,440
stationary action and I'll fight you on

174
00:05:54,360 --> 00:05:58,840
that if you want to if you want to take

175
00:05:56,440 --> 00:06:00,759
me up on that after this uh so so you

176
00:05:58,840 --> 00:06:02,560
can POS physics as and this is kind of

177
00:06:00,759 --> 00:06:05,000
the the for those who haven't seen this

178
00:06:02,560 --> 00:06:06,560
before that Q of in there is the the

179
00:06:05,000 --> 00:06:08,960
pose of your system configuration of

180
00:06:06,560 --> 00:06:10,360
your system right um and Q dots

181
00:06:08,960 --> 00:06:11,800
obviously the velocity and then this is

182
00:06:10,360 --> 00:06:14,000
the lran right so kinetic minus

183
00:06:11,800 --> 00:06:15,319
potential energy and this is classical

184
00:06:14,000 --> 00:06:17,400
stuff you probably saw in some kind of

185
00:06:15,319 --> 00:06:18,720
you know intro grad level mechanics

186
00:06:17,400 --> 00:06:20,639
course and then you probably did some

187
00:06:18,720 --> 00:06:22,360
weird calculus of variations e thing one

188
00:06:20,639 --> 00:06:24,319
time that you forgot how to do and you

189
00:06:22,360 --> 00:06:26,000
got the oiler lrange equations and if

190
00:06:24,319 --> 00:06:27,880
you're a roboticist you maybe called

191
00:06:26,000 --> 00:06:29,039
that a manipulator equation and then you

192
00:06:27,880 --> 00:06:31,160
know kind of dealt with that from then

193
00:06:29,039 --> 00:06:33,000
on and never really went back to this

194
00:06:31,160 --> 00:06:34,000
optimization formulation so I'm here to

195
00:06:33,000 --> 00:06:35,680
tell you that maybe maybe you should

196
00:06:34,000 --> 00:06:37,880
think about this a little bit more and

197
00:06:35,680 --> 00:06:40,360
there's maybe more to this so um in

198
00:06:37,880 --> 00:06:42,120
particular if we kind of like squint at

199
00:06:40,360 --> 00:06:43,880
this for a second this looks just like a

200
00:06:42,120 --> 00:06:45,280
trajectory optimization problem where

201
00:06:43,880 --> 00:06:47,440
the kind of the pose or configuration

202
00:06:45,280 --> 00:06:50,560
trajectory of the system is kind of

203
00:06:47,440 --> 00:06:52,080
doing State like things um if you and

204
00:06:50,560 --> 00:06:53,840
this is like your your cost function

205
00:06:52,080 --> 00:06:56,280
right integrated along the trajectory

206
00:06:53,840 --> 00:06:58,400
and we can go ahead and discretize this

207
00:06:56,280 --> 00:06:59,879
thing in time just like we would do with

208
00:06:58,400 --> 00:07:01,479
a trajectory optimization problem a

209
00:06:59,879 --> 00:07:03,960
motion planning problem and we can

210
00:07:01,479 --> 00:07:06,560
directly minimize this numerically and

211
00:07:03,960 --> 00:07:07,759
get out physics kind of cool why would

212
00:07:06,560 --> 00:07:10,319
you and by the way this is not a new

213
00:07:07,759 --> 00:07:12,080
idea this is uh from about 20 years ago

214
00:07:10,319 --> 00:07:13,520
from Jerry Marsden at calch and a bunch

215
00:07:12,080 --> 00:07:15,720
of his students pioneered this kind of

216
00:07:13,520 --> 00:07:16,960
thing it's called discrete mechanics um

217
00:07:15,720 --> 00:07:18,240
and there's a whole like kind of

218
00:07:16,960 --> 00:07:20,720
literature on this stuff and the the

219
00:07:18,240 --> 00:07:22,039
main takeaway is you get really cool uh

220
00:07:20,720 --> 00:07:23,240
conservation properties out of this it

221
00:07:22,039 --> 00:07:24,840
conserves energy and momentum and all

222
00:07:23,240 --> 00:07:26,840
kinds of stuff automatically and you

223
00:07:24,840 --> 00:07:28,520
don't have to uh it does very nice

224
00:07:26,840 --> 00:07:30,440
things for the for you we don't really

225
00:07:28,520 --> 00:07:31,840
care about that to be honest um runga

226
00:07:30,440 --> 00:07:33,199
cut is fine for us but there's there's

227
00:07:31,840 --> 00:07:36,479
some other kind of cool things if I can

228
00:07:33,199 --> 00:07:37,960
get it to this state um and it looks

229
00:07:36,479 --> 00:07:39,560
like a trajectory optimization problem I

230
00:07:37,960 --> 00:07:42,240
can apply all the tools I know how to

231
00:07:39,560 --> 00:07:44,400
use from numerical optimization to this

232
00:07:42,240 --> 00:07:46,280
and in particular um if I care about

233
00:07:44,400 --> 00:07:47,840
impacts and and that kind of stuff which

234
00:07:46,280 --> 00:07:49,800
show up all the time in robotics right

235
00:07:47,840 --> 00:07:51,680
if I'm walking or grabbing onto

236
00:07:49,800 --> 00:07:53,680
something that's classically really hard

237
00:07:51,680 --> 00:07:55,000
to deal with because it's nons smooth

238
00:07:53,680 --> 00:07:57,080
and technically you can't even really

239
00:07:55,000 --> 00:07:58,560
write that as an OD uh there's

240
00:07:57,080 --> 00:08:01,919
discontinuities and all kinds of Badness

241
00:07:58,560 --> 00:08:03,800
right well we take this Viewpoint we can

242
00:08:01,919 --> 00:08:05,400
actually um just deal with those as

243
00:08:03,800 --> 00:08:08,000
inequality constraints so if you imagine

244
00:08:05,400 --> 00:08:10,680
like a falling brick and you want to hit

245
00:08:08,000 --> 00:08:11,759
the ground you can just say uh you know

246
00:08:10,680 --> 00:08:13,680
Brick's not allowed to go through the

247
00:08:11,759 --> 00:08:15,560
floor and that's that inequality up

248
00:08:13,680 --> 00:08:16,639
there and then I just kind of turn the

249
00:08:15,560 --> 00:08:18,039
crank on this and solve it as a

250
00:08:16,639 --> 00:08:20,440
constrainted optimization problem and

251
00:08:18,039 --> 00:08:22,560
all the things you expect happen so um

252
00:08:20,440 --> 00:08:24,159
you know the kind of Jacobian of that

253
00:08:22,560 --> 00:08:26,080
constraint becomes the normal Vector the

254
00:08:24,159 --> 00:08:28,280
lrange multiplier becomes the normal

255
00:08:26,080 --> 00:08:30,120
force the kkt conditions end up kind of

256
00:08:28,280 --> 00:08:31,319
telling you all the things you expect

257
00:08:30,120 --> 00:08:33,519
about physics and it's it's really

258
00:08:31,319 --> 00:08:34,599
natural and really cool um and this kind

259
00:08:33,519 --> 00:08:36,120
of you know and it's all all the

260
00:08:34,599 --> 00:08:37,719
numerics are nice and there's no weird

261
00:08:36,120 --> 00:08:40,479
you know super stiff Odes it's kind of

262
00:08:37,719 --> 00:08:42,159
cool um similarly uh friction which is

263
00:08:40,479 --> 00:08:44,200
also annoying and nons smooth can be

264
00:08:42,159 --> 00:08:47,880
posed as an optimization problem anyone

265
00:08:44,200 --> 00:08:50,560
seen this before this is uh called the

266
00:08:47,880 --> 00:08:52,080
um uh maximum dissipation principle so

267
00:08:50,560 --> 00:08:55,200
it turns out if you minimize kinetic

268
00:08:52,080 --> 00:08:56,640
energy uh turns out the force due to

269
00:08:55,200 --> 00:08:58,440
kolum friction is the one that

270
00:08:56,640 --> 00:09:00,040
instantaneously sucks out the most

271
00:08:58,440 --> 00:09:01,959
kinetic energy from the system

272
00:09:00,040 --> 00:09:03,320
subject to this cone constraint called

273
00:09:01,959 --> 00:09:05,120
the friction cone which is really just a

274
00:09:03,320 --> 00:09:06,959
generalization of that whole like New

275
00:09:05,120 --> 00:09:08,680
Times normal force thing you saw in high

276
00:09:06,959 --> 00:09:11,680
school or whatever that's kind of cool

277
00:09:08,680 --> 00:09:13,320
too U okay all this physics stuff uh and

278
00:09:11,680 --> 00:09:14,279
then another one that we see all the

279
00:09:13,320 --> 00:09:16,880
time in these kind of Robotics

280
00:09:14,279 --> 00:09:18,920
applications is Collision detection so

281
00:09:16,880 --> 00:09:20,399
this is you know if I'm like the falling

282
00:09:18,920 --> 00:09:23,399
brick example well if I have slightly

283
00:09:20,399 --> 00:09:24,959
more complicated geometry just saying if

284
00:09:23,399 --> 00:09:26,600
you're touching or not becomes kind of a

285
00:09:24,959 --> 00:09:28,120
non-trivial problem right if I have some

286
00:09:26,600 --> 00:09:29,720
complicated robot with fingers and I

287
00:09:28,120 --> 00:09:31,040
want to go grasp over here I have to

288
00:09:29,720 --> 00:09:33,120
figure out what the closest points

289
00:09:31,040 --> 00:09:35,279
between all my fingers are and this you

290
00:09:33,120 --> 00:09:36,560
know non-convex object and that's kind

291
00:09:35,279 --> 00:09:38,000
of tricky it turns out and computer

292
00:09:36,560 --> 00:09:40,200
graphics people and video game people

293
00:09:38,000 --> 00:09:41,760
have spent decades trying to trying to

294
00:09:40,200 --> 00:09:44,920
make this work reliably and be fast and

295
00:09:41,760 --> 00:09:46,880
that's all great um and it turns out um

296
00:09:44,920 --> 00:09:49,440
we we've also kind of looked into this

297
00:09:46,880 --> 00:09:51,079
recently from the perspective of

298
00:09:49,440 --> 00:09:53,920
differentiability and as you can kind of

299
00:09:51,079 --> 00:09:55,800
imagine if I take two convex objects you

300
00:09:53,920 --> 00:09:59,519
know and I ask for the closest point

301
00:09:55,800 --> 00:10:01,079
between those you know distance two Norm

302
00:09:59,519 --> 00:10:03,000
a convex thing and if the shapes are

303
00:10:01,079 --> 00:10:04,360
convex you can kind of like convince

304
00:10:03,000 --> 00:10:06,519
yourself pretty easily that's a convex

305
00:10:04,360 --> 00:10:07,920
optimization problem um unfortunately

306
00:10:06,519 --> 00:10:10,240
though that has some problems in

307
00:10:07,920 --> 00:10:12,200
particular if the two objects penetrate

308
00:10:10,240 --> 00:10:13,920
each other and they kind of overlap that

309
00:10:12,200 --> 00:10:15,560
problem becomes ill posed and sort of

310
00:10:13,920 --> 00:10:18,040
breaks and that happens actually

311
00:10:15,560 --> 00:10:19,920
somewhat regularly in in real data uh

312
00:10:18,040 --> 00:10:21,600
with noise and in other kind of context

313
00:10:19,920 --> 00:10:23,640
so one of my PhD students recently came

314
00:10:21,600 --> 00:10:25,480
up with this thing which is really slick

315
00:10:23,640 --> 00:10:28,000
so it it reformulates the problem so

316
00:10:25,480 --> 00:10:31,560
rather than asking for the closest point

317
00:10:28,000 --> 00:10:33,440
it asks for the minimum sort of scaling

318
00:10:31,560 --> 00:10:35,760
uniform scaling of these two objects

319
00:10:33,440 --> 00:10:37,120
such that they just touch and that's

320
00:10:35,760 --> 00:10:39,600
kind of slick it turns out this is

321
00:10:37,120 --> 00:10:41,839
always well posed and always has a

322
00:10:39,600 --> 00:10:43,639
solution and it's also differentiable so

323
00:10:41,839 --> 00:10:45,160
you can get like nice gradients out of

324
00:10:43,639 --> 00:10:47,680
this for other Downstream you know

325
00:10:45,160 --> 00:10:50,160
applications super cool uh we call that

326
00:10:47,680 --> 00:10:52,200
deall um okay so Collision detection so

327
00:10:50,160 --> 00:10:53,839
now hopefully I've shown you like most

328
00:10:52,200 --> 00:10:55,639
of the problems I care about as a you

329
00:10:53,839 --> 00:10:59,320
know kind of motion plan and control

330
00:10:55,639 --> 00:11:00,920
robotics person uh at least can be posed

331
00:10:59,320 --> 00:11:03,600
maybe not don't have to be but can be

332
00:11:00,920 --> 00:11:05,600
posed as optimization problems so next

333
00:11:03,600 --> 00:11:06,760
part two how do we put all these things

334
00:11:05,600 --> 00:11:08,480
together right so I showed you all of

335
00:11:06,760 --> 00:11:10,639
these pieces are nice clean little

336
00:11:08,480 --> 00:11:11,959
self-contained optimization Problems But

337
00:11:10,639 --> 00:11:13,519
ultimately I need to wire it all

338
00:11:11,959 --> 00:11:17,160
together right I need the Collision

339
00:11:13,519 --> 00:11:19,680
detection thing to inform the friction

340
00:11:17,160 --> 00:11:21,639
and contact physics stuff which needs to

341
00:11:19,680 --> 00:11:23,000
talk to the control algorithm right so

342
00:11:21,639 --> 00:11:25,880
it all has to work together and that

343
00:11:23,000 --> 00:11:28,639
turns out to be kind of tricky um so as

344
00:11:25,880 --> 00:11:30,000
a brief interlude into into part two I

345
00:11:28,639 --> 00:11:32,160
want to talk a little bit about this

346
00:11:30,000 --> 00:11:34,320
kind of contact stuff which has Obsessed

347
00:11:32,160 --> 00:11:36,440
me for um the better part of a decade

348
00:11:34,320 --> 00:11:37,760
now so this all seems fine right this is

349
00:11:36,440 --> 00:11:39,880
our optimal control problem we solv

350
00:11:37,760 --> 00:11:42,200
before but if I'm doing something like

351
00:11:39,880 --> 00:11:44,000
this little quadraped robot over here

352
00:11:42,200 --> 00:11:45,560
where I'm making a breaking contact with

353
00:11:44,000 --> 00:11:48,279
the environment whole bunch the kind of

354
00:11:45,560 --> 00:11:49,279
alluded to before um that's nons smooth

355
00:11:48,279 --> 00:11:51,519
right so if you write down kind of

356
00:11:49,279 --> 00:11:53,560
normal f equals ma stuff for that you

357
00:11:51,519 --> 00:11:55,480
end up with either really really stiff

358
00:11:53,560 --> 00:11:57,480
Odes that are a huge pain to deal with

359
00:11:55,480 --> 00:11:59,560
or you end up with sort of switching

360
00:11:57,480 --> 00:12:02,399
constraints that are uh sort of integer

361
00:11:59,560 --> 00:12:03,600
flavored which is also bad um so you

362
00:12:02,399 --> 00:12:04,880
kind of have this smoothness issue

363
00:12:03,600 --> 00:12:07,279
floating around and it turns out

364
00:12:04,880 --> 00:12:08,839
standard numerical techniques for

365
00:12:07,279 --> 00:12:10,800
solving these problems kind of don't

366
00:12:08,839 --> 00:12:12,720
apply here and you need to do something

367
00:12:10,800 --> 00:12:14,720
else there's there's kind of a couple

368
00:12:12,720 --> 00:12:16,199
ways people have typically dealt with it

369
00:12:14,720 --> 00:12:18,040
one which is I would say kind of the

370
00:12:16,199 --> 00:12:19,920
industry standard approach is this

371
00:12:18,040 --> 00:12:22,199
so-called hybrid approach and that is

372
00:12:19,920 --> 00:12:25,880
kind of doing that integer flavored

373
00:12:22,199 --> 00:12:28,199
thing where you enumerate all the times

374
00:12:25,880 --> 00:12:30,240
and locations where contact switches

375
00:12:28,199 --> 00:12:31,920
happen and you have to do this with some

376
00:12:30,240 --> 00:12:34,480
kind of heuristic or some Oracle or

377
00:12:31,920 --> 00:12:36,000
whatever so if you know those times then

378
00:12:34,480 --> 00:12:38,680
you can bake them into the problem

379
00:12:36,000 --> 00:12:40,399
formulation as given and basically get

380
00:12:38,680 --> 00:12:41,720
them out of the optimization problem and

381
00:12:40,399 --> 00:12:44,079
then you're just optimizing over the

382
00:12:41,720 --> 00:12:45,279
smooth arcs between those context

383
00:12:44,079 --> 00:12:46,639
switching events and that's back to a

384
00:12:45,279 --> 00:12:48,639
problem we know how to solve well so

385
00:12:46,639 --> 00:12:50,519
that's one approach the downside is now

386
00:12:48,639 --> 00:12:52,720
you need some way to pre-specify those

387
00:12:50,519 --> 00:12:54,160
what are called mode switches um so you

388
00:12:52,720 --> 00:12:56,079
you know in leged robotics maybe this

389
00:12:54,160 --> 00:12:58,040
isn't too hard if your you know Left

390
00:12:56,079 --> 00:12:59,440
Foot Right Foot but it it quickly breaks

391
00:12:58,040 --> 00:13:01,519
down and becomes intractable if you're

392
00:12:59,440 --> 00:13:03,880
doing like really complicated inhand

393
00:13:01,519 --> 00:13:05,639
manipulation stuff where the contacts

394
00:13:03,880 --> 00:13:08,160
can be really rich that can be super

395
00:13:05,639 --> 00:13:09,760
hard right okay so I have to say though

396
00:13:08,160 --> 00:13:11,440
this this is kind of I I alluded to this

397
00:13:09,760 --> 00:13:13,600
is kind of the standard thing to do and

398
00:13:11,440 --> 00:13:15,760
it's been really really successful so

399
00:13:13,600 --> 00:13:16,800
you know we've all seen these videos um

400
00:13:15,760 --> 00:13:18,880
this is kind of what these guys are

401
00:13:16,800 --> 00:13:20,959
doing and and every other you know

402
00:13:18,880 --> 00:13:21,880
really cool looking legged robot video

403
00:13:20,959 --> 00:13:24,760
for that matter but these guys have

404
00:13:21,880 --> 00:13:27,079
taken us obviously really really far um

405
00:13:24,760 --> 00:13:28,079
okay so the other thing I love about

406
00:13:27,079 --> 00:13:29,959
these guys though is they actually

407
00:13:28,079 --> 00:13:30,880
published the blooper video videos we're

408
00:13:29,959 --> 00:13:33,279
going to look at one of these blooper

409
00:13:30,880 --> 00:13:36,600
videos real quick and I want to actually

410
00:13:33,279 --> 00:13:38,839
ask you to look really carefully uh at

411
00:13:36,600 --> 00:13:41,040
when these um these kind of you know

412
00:13:38,839 --> 00:13:43,040
bloopers happen so this is a really good

413
00:13:41,040 --> 00:13:45,920
one that I slowed down so what happened

414
00:13:43,040 --> 00:13:48,800
there why did it face

415
00:13:45,920 --> 00:13:50,920
plant putot touch the beam right so in

416
00:13:48,800 --> 00:13:53,759
in the lingo that we were just kind of

417
00:13:50,920 --> 00:13:56,079
like you know kind of going for here um

418
00:13:53,759 --> 00:13:57,320
with you know modes and all this kind of

419
00:13:56,079 --> 00:13:59,560
stuff what happened there was an

420
00:13:57,320 --> 00:14:01,160
unplanned contact switch

421
00:13:59,560 --> 00:14:03,600
so another way of saying this right if

422
00:14:01,160 --> 00:14:07,600
I'm doing this pre-specification of flit

423
00:14:03,600 --> 00:14:10,320
steps and all this the controller is uh

424
00:14:07,600 --> 00:14:11,800
really open loop on the contact modes I

425
00:14:10,320 --> 00:14:13,519
have to pre-specify when those things

426
00:14:11,800 --> 00:14:14,759
are happening I might have some outer

427
00:14:13,519 --> 00:14:16,800
loop heuristics that are trying to

428
00:14:14,759 --> 00:14:19,279
update those things online but the the

429
00:14:16,800 --> 00:14:20,519
actual control uh opal control solver

430
00:14:19,279 --> 00:14:22,720
that's doing this at you know a couple

431
00:14:20,519 --> 00:14:25,320
hundred Herz or whatever it can't reason

432
00:14:22,720 --> 00:14:27,880
about uh anything like that so when the

433
00:14:25,320 --> 00:14:29,880
foot touches the you know the ground uh

434
00:14:27,880 --> 00:14:31,560
or the the beam there the controller

435
00:14:29,880 --> 00:14:33,800
doesn't know about that it doesn't know

436
00:14:31,560 --> 00:14:35,680
that the environment can exert forces at

437
00:14:33,800 --> 00:14:37,360
that location on the body it has just no

438
00:14:35,680 --> 00:14:39,279
knowledge of whatsoever and it

439
00:14:37,360 --> 00:14:40,920
completely fails so this is kind of I I

440
00:14:39,279 --> 00:14:42,240
would argue a really deep issue that we

441
00:14:40,920 --> 00:14:44,759
don't currently have control methods

442
00:14:42,240 --> 00:14:48,199
that can reason about uh this kind of

443
00:14:44,759 --> 00:14:50,320
physics in a in a rigorous way okay so

444
00:14:48,199 --> 00:14:51,680
there is another way uh this is called

445
00:14:50,320 --> 00:14:54,800
Contact implicit and people have been

446
00:14:51,680 --> 00:14:57,959
working on this for you know decade plus

447
00:14:54,800 --> 00:14:59,839
um including you know people here uh and

448
00:14:57,959 --> 00:15:01,320
historically the is is with this here

449
00:14:59,839 --> 00:15:03,199
you're trying to solve for the the whole

450
00:15:01,320 --> 00:15:05,000
thing right the the modes the contact

451
00:15:03,199 --> 00:15:06,720
forces and the problem with that right

452
00:15:05,000 --> 00:15:08,600
is all this non- smoother integer

453
00:15:06,720 --> 00:15:11,040
flavored Badness so typically these have

454
00:15:08,600 --> 00:15:12,560
like really serious numerical problems

455
00:15:11,040 --> 00:15:14,199
they either take way too long to solve

456
00:15:12,560 --> 00:15:16,440
or you end up with ill conditioning

457
00:15:14,199 --> 00:15:17,800
because of stiff you know Odes and it

458
00:15:16,440 --> 00:15:19,920
just kind of hasn't really worked out

459
00:15:17,800 --> 00:15:21,519
that great historically okay so now

460
00:15:19,920 --> 00:15:22,680
we're going to try to like fix those

461
00:15:21,519 --> 00:15:25,360
problems and I'm going to kind of walk

462
00:15:22,680 --> 00:15:26,600
you through the way that uh sort of like

463
00:15:25,360 --> 00:15:29,360
we've come up with thinking about this

464
00:15:26,600 --> 00:15:31,440
in my lab I call this composable optim

465
00:15:29,360 --> 00:15:32,880
so the gist is all these little blocks I

466
00:15:31,440 --> 00:15:35,199
just walked you through we've developed

467
00:15:32,880 --> 00:15:37,199
techniques for solving those well and

468
00:15:35,199 --> 00:15:38,560
ultimately we need to hook them together

469
00:15:37,199 --> 00:15:40,880
and so now I'm going to talk through

470
00:15:38,560 --> 00:15:43,120
like how we approach that hooking

471
00:15:40,880 --> 00:15:45,959
together and essentially like jointly

472
00:15:43,120 --> 00:15:48,519
solving this entire coupled mess of

473
00:15:45,959 --> 00:15:50,199
optimization problems jointly right okay

474
00:15:48,519 --> 00:15:52,240
so the the first key idea here is what

475
00:15:50,199 --> 00:15:54,279
we call a differentiable interior Point

476
00:15:52,240 --> 00:15:56,440
method we've seen interior Point methods

477
00:15:54,279 --> 00:15:58,560
before like pretty standard way to solve

478
00:15:56,440 --> 00:16:00,839
constrainted optimization problems right

479
00:15:58,560 --> 00:16:02,759
okay so we're going to like go with this

480
00:16:00,839 --> 00:16:05,040
sort of very simple prototypical problem

481
00:16:02,759 --> 00:16:06,880
where you've got cost function and a

482
00:16:05,040 --> 00:16:09,079
single like inequality constraint just

483
00:16:06,880 --> 00:16:10,560
to kind of illustrate the idea and the

484
00:16:09,079 --> 00:16:13,440
thing that's key here is that we're

485
00:16:10,560 --> 00:16:15,639
minimizing over X so X is what we call

486
00:16:13,440 --> 00:16:17,240
the decision variable and then there's

487
00:16:15,639 --> 00:16:18,839
this other variable floating around Y

488
00:16:17,240 --> 00:16:20,440
which we're not optimizing over and

489
00:16:18,839 --> 00:16:21,920
we'll call that the problem data or

490
00:16:20,440 --> 00:16:23,759
problem parameter or something like this

491
00:16:21,920 --> 00:16:25,399
so the idea is that the solution to this

492
00:16:23,759 --> 00:16:27,199
thing depends on why but we're not

493
00:16:25,399 --> 00:16:29,560
optimizing over why it's like this sort

494
00:16:27,199 --> 00:16:31,199
of input to the problem cool

495
00:16:29,560 --> 00:16:32,440
okay so I said that out loud okay so

496
00:16:31,199 --> 00:16:35,079
what we're going to do now is imagine

497
00:16:32,440 --> 00:16:37,120
that this block here is the K friction

498
00:16:35,079 --> 00:16:38,639
box just for illustrative purposes right

499
00:16:37,120 --> 00:16:40,240
so that's this block we're going to zoom

500
00:16:38,639 --> 00:16:41,519
in a little bit so for for illustrative

501
00:16:40,240 --> 00:16:42,920
purposes right this inequality is going

502
00:16:41,519 --> 00:16:43,839
to be that friction cone thing that we

503
00:16:42,920 --> 00:16:47,360
talked

504
00:16:43,839 --> 00:16:49,040
about and this x is going to be the

505
00:16:47,360 --> 00:16:50,839
friction Force so we're trying to solve

506
00:16:49,040 --> 00:16:53,160
for the friction Force but remember that

507
00:16:50,839 --> 00:16:54,839
thing also depends on the normal force

508
00:16:53,160 --> 00:16:56,639
right so I'm not optimizing over the

509
00:16:54,839 --> 00:16:58,079
normal force but the friction answer

510
00:16:56,639 --> 00:16:59,519
depends on the magnitude of the normal

511
00:16:58,079 --> 00:17:01,160
force so that normal force is going to

512
00:16:59,519 --> 00:17:05,520
be our our problem parameter right that

513
00:17:01,160 --> 00:17:06,600
this thing depends on okay so and you

514
00:17:05,520 --> 00:17:09,039
could flip this around right if this

515
00:17:06,600 --> 00:17:11,600
were the uh the normal force coming from

516
00:17:09,039 --> 00:17:13,240
the the contact the impact mechanics box

517
00:17:11,600 --> 00:17:14,679
right and if you flip this around that

518
00:17:13,240 --> 00:17:16,439
impact mechanics thing depends on the

519
00:17:14,679 --> 00:17:17,640
coolum friction and it's solving for the

520
00:17:16,439 --> 00:17:19,120
normal force right so there's kind of

521
00:17:17,640 --> 00:17:20,319
symmetry there you can hook these all

522
00:17:19,120 --> 00:17:23,400
together but they all depend on each

523
00:17:20,319 --> 00:17:25,160
other right okay so uh first trick is we

524
00:17:23,400 --> 00:17:27,039
take this thing and this is just

525
00:17:25,160 --> 00:17:28,960
interior Point methods 101 we're going

526
00:17:27,039 --> 00:17:31,039
to take that inequality constraint and

527
00:17:28,960 --> 00:17:33,200
and varried inside this thing called a

528
00:17:31,039 --> 00:17:35,240
log barrier it's just a log which blows

529
00:17:33,200 --> 00:17:37,200
up as the C of X as that constraint

530
00:17:35,240 --> 00:17:38,559
approaches zero right and we stick it in

531
00:17:37,200 --> 00:17:40,080
the objective function so how we

532
00:17:38,559 --> 00:17:42,200
basically remove the constraint and put

533
00:17:40,080 --> 00:17:43,400
it inside the cost and just to kind of

534
00:17:42,200 --> 00:17:44,960
give you an idea of what this looks like

535
00:17:43,400 --> 00:17:46,280
right we have this little tuning

536
00:17:44,960 --> 00:17:48,120
parameter row out front which we call

537
00:17:46,280 --> 00:17:51,200
the barrier parameter the idea is as you

538
00:17:48,120 --> 00:17:53,919
crank that this log which is nice and

539
00:17:51,200 --> 00:17:55,679
smooth kind of gradually approaches a

540
00:17:53,919 --> 00:17:57,080
brick wall which is non- differentiable

541
00:17:55,679 --> 00:17:58,600
right so in the limit becomes

542
00:17:57,080 --> 00:18:00,919
non-differentiable but for any finite

543
00:17:58,600 --> 00:18:02,280
row it's differentiable and nice and

544
00:18:00,919 --> 00:18:04,400
right we've been doing this for decades

545
00:18:02,280 --> 00:18:06,240
now and it's super Works super well and

546
00:18:04,400 --> 00:18:08,360
that sort of smoothing effect is what

547
00:18:06,240 --> 00:18:10,039
lets you actually get gradients out and

548
00:18:08,360 --> 00:18:11,760
solve this thing efficiently with with

549
00:18:10,039 --> 00:18:14,880
Newton's method or whatever you like

550
00:18:11,760 --> 00:18:16,200
Okay cool so this thing we take this and

551
00:18:14,880 --> 00:18:17,840
then we're going to write down the

552
00:18:16,200 --> 00:18:19,799
optimality conditions for this guy which

553
00:18:17,840 --> 00:18:21,400
are kkt conditions if you if you know

554
00:18:19,799 --> 00:18:22,799
what that is but I'll really just like

555
00:18:21,400 --> 00:18:24,559
basically setting the gradient equal to

556
00:18:22,799 --> 00:18:26,720
zero right like freshman calculus kind

557
00:18:24,559 --> 00:18:28,799
of stuff and set the gradient equal to

558
00:18:26,720 --> 00:18:30,120
zero and solve that root finding problem

559
00:18:28,799 --> 00:18:32,679
for zero right there so that's what

560
00:18:30,120 --> 00:18:33,720
we're going to call R okay so that's you

561
00:18:32,679 --> 00:18:35,400
know I take the gradient of this thing

562
00:18:33,720 --> 00:18:37,679
with respect to X set it equal to zero

563
00:18:35,400 --> 00:18:41,000
still depends on y though right okay so

564
00:18:37,679 --> 00:18:42,480
the key next move is if I've got that I

565
00:18:41,000 --> 00:18:45,159
can use this trick called the implicit

566
00:18:42,480 --> 00:18:46,559
function theorem we've seen this before

567
00:18:45,159 --> 00:18:48,600
couple people so the idea here is if I

568
00:18:46,559 --> 00:18:51,240
got that R of X and Y I tailor expand it

569
00:18:48,600 --> 00:18:52,840
in both X and Y and I just kind of move

570
00:18:51,240 --> 00:18:54,480
move stuff over to one side and I can

571
00:18:52,840 --> 00:18:57,919
solve for

572
00:18:54,480 --> 00:19:00,559
dxdy okay so now what this did for me is

573
00:18:57,919 --> 00:19:04,880
all together now this block I can treat

574
00:19:00,559 --> 00:19:08,320
it as a normal function X of Y and I

575
00:19:04,880 --> 00:19:10,200
have its derivative DX Dy internally

576
00:19:08,320 --> 00:19:12,840
it's doing some crazy stuff with you

577
00:19:10,200 --> 00:19:14,760
know a numerical solver but outside the

578
00:19:12,840 --> 00:19:16,360
box it just looks like a normal function

579
00:19:14,760 --> 00:19:18,480
that I can query and I can also query it

580
00:19:16,360 --> 00:19:20,440
for its derivativ so now in principle I

581
00:19:18,480 --> 00:19:22,000
can take this entire optimization solver

582
00:19:20,440 --> 00:19:23,720
and treat it as just any other

583
00:19:22,000 --> 00:19:25,600
differentiable function can do whatever

584
00:19:23,720 --> 00:19:27,159
I want with it I can optimize with it I

585
00:19:25,600 --> 00:19:29,120
can bury it inside a constraint function

586
00:19:27,159 --> 00:19:30,840
and another optimization problem I can

587
00:19:29,120 --> 00:19:32,360
put in an objective function whatever I

588
00:19:30,840 --> 00:19:36,360
want and this is kind of the the magic

589
00:19:32,360 --> 00:19:38,840
trick that lets you do this wiring Okay

590
00:19:36,360 --> 00:19:42,880
cool so far feel free to bug me and

591
00:19:38,840 --> 00:19:42,880
interrupt if you you know have thoughts

592
00:19:42,960 --> 00:19:47,880
yeah turns out log the log barrier is

593
00:19:45,960 --> 00:19:49,280
somewhat magical there's a whole like

594
00:19:47,880 --> 00:19:50,679
really highly developed theory for these

595
00:19:49,280 --> 00:19:52,559
interior Point methods you can use other

596
00:19:50,679 --> 00:19:53,720
barrier functions the main property you

597
00:19:52,559 --> 00:19:55,400
need to have is that they blow up to

598
00:19:53,720 --> 00:19:57,039
Infinity at the constraint boundary

599
00:19:55,400 --> 00:19:59,159
that's why they're called interior they

600
00:19:57,039 --> 00:20:00,720
keep you inside the feasible region

601
00:19:59,159 --> 00:20:03,280
uh you can use some other functions

602
00:20:00,720 --> 00:20:04,200
these things um there's this magic this

603
00:20:03,280 --> 00:20:05,400
is not going to make any sense you can

604
00:20:04,200 --> 00:20:07,679
look this up if you want it's called a

605
00:20:05,400 --> 00:20:09,600
self-concordant function and that's what

606
00:20:07,679 --> 00:20:11,039
you really want for a barrier to be nice

607
00:20:09,600 --> 00:20:13,120
it basically means its higher order

608
00:20:11,039 --> 00:20:14,960
terms and its tailor series are bounded

609
00:20:13,120 --> 00:20:16,559
in a nice way such that Newton's method

610
00:20:14,960 --> 00:20:18,960
or gradient-based optimization methods

611
00:20:16,559 --> 00:20:21,520
that rely on tailor expansions work well

612
00:20:18,960 --> 00:20:23,720
on it so that's kind of why log is nice

613
00:20:21,520 --> 00:20:25,080
there are other examples of barriers

614
00:20:23,720 --> 00:20:27,200
that have that property that you can

615
00:20:25,080 --> 00:20:30,640
make up or find But like everyone uses

616
00:20:27,200 --> 00:20:30,640
log and it works super well

617
00:20:36,159 --> 00:20:40,440
yeah you want to you absolutely do yeah

618
00:20:39,280 --> 00:20:42,120
yeah so this is a thing there's been a

619
00:20:40,440 --> 00:20:45,039
bunch of work on this convex layers from

620
00:20:42,120 --> 00:20:47,159
ziko couter and and others um basically

621
00:20:45,039 --> 00:20:48,720
the other option here is to if you did

622
00:20:47,159 --> 00:20:50,520
autod diffing for example on this

623
00:20:48,720 --> 00:20:53,000
algorithm it's going to unroll the

624
00:20:50,520 --> 00:20:54,640
solver Loop and you're so this thing

625
00:20:53,000 --> 00:20:57,080
might take you know a dozen iterations

626
00:20:54,640 --> 00:20:58,760
to con converge if you unroll that with

627
00:20:57,080 --> 00:21:00,400
an autod diffing toolbox it's it's going

628
00:20:58,760 --> 00:21:02,600
to take a ton of memory and basically

629
00:21:00,400 --> 00:21:06,280
just not work so what this lets you do

630
00:21:02,600 --> 00:21:08,240
is you can hand code uh this this you

631
00:21:06,280 --> 00:21:10,720
know uh the other thing to mention is

632
00:21:08,240 --> 00:21:12,240
that that Jacobian you if you solve this

633
00:21:10,720 --> 00:21:13,760
with Newton's method for instance where

634
00:21:12,240 --> 00:21:15,799
you're you're already evaluating those

635
00:21:13,760 --> 00:21:17,840
derivatives so this is free so at

636
00:21:15,799 --> 00:21:20,960
convergence the algorithm I can give you

637
00:21:17,840 --> 00:21:24,760
that Jacobian for free almost cool

638
00:21:20,960 --> 00:21:26,080
anybody else all right moving on okay so

639
00:21:24,760 --> 00:21:27,360
what do we do with this so the first

640
00:21:26,080 --> 00:21:29,120
thing we did with this is we kind of

641
00:21:27,360 --> 00:21:30,760
wired these blocks together like the

642
00:21:29,120 --> 00:21:32,159
impact Dynamic stuff coolum friction and

643
00:21:30,760 --> 00:21:34,679
collision detection stuff made a

644
00:21:32,159 --> 00:21:36,720
simulator we call this thing Dojo U it's

645
00:21:34,679 --> 00:21:37,960
kind of cool in that it has these these

646
00:21:36,720 --> 00:21:41,000
kind of nice properties that I would

647
00:21:37,960 --> 00:21:42,960
argue no other simulator really has um

648
00:21:41,000 --> 00:21:45,159
in spite of lots of investment by lots

649
00:21:42,960 --> 00:21:48,200
of big tech companies so first of all it

650
00:21:45,159 --> 00:21:49,919
it does real hard contact as in you know

651
00:21:48,200 --> 00:21:51,880
I don't get forces off the ground in the

652
00:21:49,919 --> 00:21:53,919
air and I don't penetrate through the

653
00:21:51,880 --> 00:21:55,760
ground both of these are very common in

654
00:21:53,919 --> 00:21:57,640
current robotic simulators for various

655
00:21:55,760 --> 00:21:58,880
reasons um you also don't get yes you

656
00:21:57,640 --> 00:22:00,400
don't get any inter penetration where

657
00:21:58,880 --> 00:22:02,799
you sink into the floor which you know

658
00:22:00,400 --> 00:22:04,240
things like Moko do that a lot um you

659
00:22:02,799 --> 00:22:05,799
also don't get creep so it turns out a

660
00:22:04,240 --> 00:22:08,480
bunch of these other simulators they do

661
00:22:05,799 --> 00:22:11,360
very smoothing tricks and they can't

662
00:22:08,480 --> 00:22:13,120
actually do kolum friction which is

663
00:22:11,360 --> 00:22:15,240
fundamentally non-s smooth so they can't

664
00:22:13,120 --> 00:22:17,520
do stick slip so if you put something on

665
00:22:15,240 --> 00:22:19,520
an inclin plane it's always going to

666
00:22:17,520 --> 00:22:21,640
creep a little bit it never actually

667
00:22:19,520 --> 00:22:23,240
gets sticking friction which is annoying

668
00:22:21,640 --> 00:22:24,840
and then I kind of alluded to before

669
00:22:23,240 --> 00:22:26,279
that we get really nice energy and

670
00:22:24,840 --> 00:22:29,080
momentum conservation properties because

671
00:22:26,279 --> 00:22:30,880
of that magical uh discret mechanic

672
00:22:29,080 --> 00:22:32,080
stuff which we don't NE care too much

673
00:22:30,880 --> 00:22:33,600
about but it is nice it means you're

674
00:22:32,080 --> 00:22:35,279
stable and you can take big time steps

675
00:22:33,600 --> 00:22:36,919
and that kind of stuff simulate really

676
00:22:35,279 --> 00:22:37,919
quickly and the last one right as we we

677
00:22:36,919 --> 00:22:39,520
already know we can we can actually give

678
00:22:37,919 --> 00:22:41,960
you the gradients of all this stuff that

679
00:22:39,520 --> 00:22:43,960
lets us do optimization in kind of

680
00:22:41,960 --> 00:22:45,200
outside of this in an outer loop and a

681
00:22:43,960 --> 00:22:46,919
couple examples that right so this is

682
00:22:45,200 --> 00:22:49,200
just showing you this is like showing

683
00:22:46,919 --> 00:22:51,159
you the derivatives of an impact or a

684
00:22:49,200 --> 00:22:53,600
stick slip trans transition as a

685
00:22:51,159 --> 00:22:56,279
function of that row barrier parameter

686
00:22:53,600 --> 00:22:57,679
so I can give you any smooth version of

687
00:22:56,279 --> 00:22:59,760
this you want and kind of one of the

688
00:22:57,679 --> 00:23:02,120
interesting things here is that I can

689
00:22:59,760 --> 00:23:03,840
simulate the hard impact which is the

690
00:23:02,120 --> 00:23:05,799
black line but then if you want to do

691
00:23:03,840 --> 00:23:07,799
optimization that's terrible so the idea

692
00:23:05,799 --> 00:23:09,279
is I give you the answer with the hard

693
00:23:07,799 --> 00:23:10,799
impact but then if you ask me for the

694
00:23:09,279 --> 00:23:13,480
gradient I give you one of those pink

695
00:23:10,799 --> 00:23:15,039
curves and I cach them as I converge and

696
00:23:13,480 --> 00:23:17,400
I can give you any one of those you want

697
00:23:15,039 --> 00:23:18,799
so you kind of give me this kind of

698
00:23:17,400 --> 00:23:22,000
relaxation that you're willing to

699
00:23:18,799 --> 00:23:23,720
tolerate on the derivatives um but you

700
00:23:22,000 --> 00:23:26,880
can still get the real physics answer

701
00:23:23,720 --> 00:23:29,120
which is kind of an interesting thing um

702
00:23:26,880 --> 00:23:30,760
okay so I get gradients now I'm going to

703
00:23:29,120 --> 00:23:31,960
tell you I lied to you a little bit uh

704
00:23:30,760 --> 00:23:32,880
about something subtle and I just want

705
00:23:31,960 --> 00:23:35,679
to point this out because it's very

706
00:23:32,880 --> 00:23:38,720
subtle um and I I stole this language

707
00:23:35,679 --> 00:23:40,159
from the like FEA cfd people which we'

708
00:23:38,720 --> 00:23:42,039
we started talking about for some other

709
00:23:40,159 --> 00:23:44,640
stuff um so they have this notion of

710
00:23:42,039 --> 00:23:46,320
strong versus weak coupling and this is

711
00:23:44,640 --> 00:23:47,600
like a good illustration of it so the

712
00:23:46,320 --> 00:23:49,919
thing on the left is what I would call

713
00:23:47,600 --> 00:23:52,240
weekly coupled what's going on here if I

714
00:23:49,919 --> 00:23:54,640
have this Collision detection box and

715
00:23:52,240 --> 00:23:56,159
this impact mechanics box right if I

716
00:23:54,640 --> 00:23:57,799
just treat these like functions and

717
00:23:56,159 --> 00:23:59,480
query them which is what most simulators

718
00:23:57,799 --> 00:24:01,240
right now do about by the way so if I

719
00:23:59,480 --> 00:24:03,520
have these boxes and they're about to

720
00:24:01,240 --> 00:24:05,279
collide and I ask you for the closest

721
00:24:03,520 --> 00:24:06,640
point between the two boxes if I have

722
00:24:05,279 --> 00:24:08,240
these two boxes and let's say

723
00:24:06,640 --> 00:24:10,120
everything's perfect right and I it's in

724
00:24:08,240 --> 00:24:11,840
my simulator if I put them like this

725
00:24:10,120 --> 00:24:14,919
right on top of each other what's the

726
00:24:11,840 --> 00:24:14,919
closest point between those two

727
00:24:15,080 --> 00:24:22,039
boxes it's it's ill posed right it can

728
00:24:17,720 --> 00:24:24,880
be anything on that surface um so how do

729
00:24:22,039 --> 00:24:27,000
I pick one if I use a collision Library

730
00:24:24,880 --> 00:24:28,480
which is standard right there's fcl

731
00:24:27,000 --> 00:24:30,640
there's things like this out there and

732
00:24:28,480 --> 00:24:32,240
give it that problem it has to return an

733
00:24:30,640 --> 00:24:33,679
answer to me so what's it going to do

734
00:24:32,240 --> 00:24:34,880
well in general it's going to regularize

735
00:24:33,679 --> 00:24:36,240
somehow and it's probably going to give

736
00:24:34,880 --> 00:24:38,760
me something like the geometric Center

737
00:24:36,240 --> 00:24:40,960
at the centroid of that face perfectly

738
00:24:38,760 --> 00:24:43,120
reasonable in the absence of any other

739
00:24:40,960 --> 00:24:44,240
you know choice right so if I just run

740
00:24:43,120 --> 00:24:46,159
my simulator where I query that

741
00:24:44,240 --> 00:24:47,640
Collision detection thing get the point

742
00:24:46,159 --> 00:24:50,360
and then plug it into my simulator with

743
00:24:47,640 --> 00:24:52,320
some force model and simulate a step you

744
00:24:50,360 --> 00:24:53,760
get the thing on the left so basically

745
00:24:52,320 --> 00:24:56,399
what's happening there is it's it's

746
00:24:53,760 --> 00:24:57,240
giving me the centroid um but it doesn't

747
00:24:56,399 --> 00:24:58,760
know anything about the mass

748
00:24:57,240 --> 00:25:00,559
distribution of the boxes or anything

749
00:24:58,760 --> 00:25:02,960
else and so it turns out if you line

750
00:25:00,559 --> 00:25:04,600
these up off center even a little bit

751
00:25:02,960 --> 00:25:06,120
they can't balance on top of each other

752
00:25:04,600 --> 00:25:09,039
you get this weird unphysical artifact

753
00:25:06,120 --> 00:25:10,760
of them bouncing in practice all these

754
00:25:09,039 --> 00:25:13,000
simulators Implement a bunch of hacks to

755
00:25:10,760 --> 00:25:14,080
try to avoid this but it's it's there

756
00:25:13,000 --> 00:25:15,960
from the the fundamentals of the

757
00:25:14,080 --> 00:25:17,679
formulation what you want to do instead

758
00:25:15,960 --> 00:25:19,760
is this thing on the right which we call

759
00:25:17,679 --> 00:25:22,080
strongly coupled so what that is really

760
00:25:19,760 --> 00:25:23,520
doing is embracing this idea that these

761
00:25:22,080 --> 00:25:25,440
um these things depend on each other and

762
00:25:23,520 --> 00:25:26,760
you have to solve them jointly and

763
00:25:25,440 --> 00:25:28,360
something really cool actually happens

764
00:25:26,760 --> 00:25:30,039
here so this Collision thing where I I

765
00:25:28,360 --> 00:25:32,720
have the face on face box thing that's

766
00:25:30,039 --> 00:25:34,279
ill posed it turns out if I take that

767
00:25:32,720 --> 00:25:36,360
problem and solve it jointly with the

768
00:25:34,279 --> 00:25:37,880
physics problem the physics problem is

769
00:25:36,360 --> 00:25:39,159
using that least action thing you can

770
00:25:37,880 --> 00:25:42,080
kind of think of that as like an energy

771
00:25:39,159 --> 00:25:43,960
minimization kind of metric right turns

772
00:25:42,080 --> 00:25:46,760
out that energy minimization thing from

773
00:25:43,960 --> 00:25:48,480
the impact Dynamics regularizes the

774
00:25:46,760 --> 00:25:50,640
Collision detection problem if you solve

775
00:25:48,480 --> 00:25:52,520
them jointly and the answer you get out

776
00:25:50,640 --> 00:25:54,200
for the closest point is the one that

777
00:25:52,520 --> 00:25:56,799
minimizes the action like basically

778
00:25:54,200 --> 00:25:58,559
minimizes the energy and then you get

779
00:25:56,799 --> 00:26:00,919
then it gives you the correct balance

780
00:25:58,559 --> 00:26:02,799
point and it all works out and you get

781
00:26:00,919 --> 00:26:06,720
like sort of physically the right kind

782
00:26:02,799 --> 00:26:07,799
of simulation so um to explain in a

783
00:26:06,720 --> 00:26:09,240
little more detail like what this

784
00:26:07,799 --> 00:26:10,880
actually looks like under the hood we

785
00:26:09,240 --> 00:26:12,399
have these two boxes and we talked about

786
00:26:10,880 --> 00:26:14,200
writing down their first order necessary

787
00:26:12,399 --> 00:26:15,919
conditions their their gradients the

788
00:26:14,200 --> 00:26:18,480
first one I'm solving with respect to X

789
00:26:15,919 --> 00:26:20,559
so that might be you know the Collision

790
00:26:18,480 --> 00:26:23,720
uh detection stuff and X is the closest

791
00:26:20,559 --> 00:26:24,799
point and then Y is like the pose right

792
00:26:23,720 --> 00:26:26,559
and then the second one might be our

793
00:26:24,799 --> 00:26:28,640
impact Dynamics where Y is you know the

794
00:26:26,559 --> 00:26:30,360
pose and X is the closest point right so

795
00:26:28,640 --> 00:26:31,760
vice versa and I write down the first

796
00:26:30,360 --> 00:26:33,760
order necessary conditions for both of

797
00:26:31,760 --> 00:26:36,279
them so great and equal zero stuff I

798
00:26:33,760 --> 00:26:38,080
stack them together like this so they're

799
00:26:36,279 --> 00:26:40,279
coupled right those those kkt conditions

800
00:26:38,080 --> 00:26:42,399
those first order conditions they depend

801
00:26:40,279 --> 00:26:45,520
on each other and if I stack them like

802
00:26:42,399 --> 00:26:47,480
this and solve that problem jointly uh

803
00:26:45,520 --> 00:26:49,520
with say Newton's method then I get the

804
00:26:47,480 --> 00:26:51,320
right answer basically so they're able

805
00:26:49,520 --> 00:26:53,399
to inform each other as you iterate

806
00:26:51,320 --> 00:26:56,600
inside the solver and give you the right

807
00:26:53,399 --> 00:26:58,880
answer okay so far so good they have

808
00:26:56,600 --> 00:27:00,039
anything bug me with all right

809
00:26:58,880 --> 00:27:01,240
okay so we can do lots of cool things

810
00:27:00,039 --> 00:27:02,679
with this I mentioned you know we get

811
00:27:01,240 --> 00:27:05,320
the smooth gradients and all the all

812
00:27:02,679 --> 00:27:07,320
that stuff so you can do kind of uh kind

813
00:27:05,320 --> 00:27:09,240
of vanilla trajectory optimization stuff

814
00:27:07,320 --> 00:27:10,720
you can do RL that's the middle one

815
00:27:09,240 --> 00:27:12,480
where you actually use the gradients and

816
00:27:10,720 --> 00:27:15,000
just do actual gradient descent instead

817
00:27:12,480 --> 00:27:16,799
of like SGD kind of stuff and that has

818
00:27:15,000 --> 00:27:18,200
obvious benefits you can also do system

819
00:27:16,799 --> 00:27:20,279
ID so we diff through this kind of

820
00:27:18,200 --> 00:27:22,240
collision stuff and solve for the Box

821
00:27:20,279 --> 00:27:23,840
geometry um and you can do kind of other

822
00:27:22,240 --> 00:27:26,240
fun motion planning things that thing on

823
00:27:23,840 --> 00:27:27,600
the bottom um is using gradients to

824
00:27:26,240 --> 00:27:31,320
solve this like kind of simple motion

825
00:27:27,600 --> 00:27:32,039
planning problem an arm okay cool we

826
00:27:31,320 --> 00:27:33,919
have

827
00:27:32,039 --> 00:27:35,320
gradients um so we care about doing

828
00:27:33,919 --> 00:27:37,039
control we spend a lot of time thinking

829
00:27:35,320 --> 00:27:39,200
about trajectory optimization and model

830
00:27:37,039 --> 00:27:40,640
predictive control in my group and so

831
00:27:39,200 --> 00:27:41,720
now we've got all these pieces right and

832
00:27:40,640 --> 00:27:43,440
we could go solve this trajectory

833
00:27:41,720 --> 00:27:45,799
optimization problem so we did that here

834
00:27:43,440 --> 00:27:47,399
are some examples um punchline though

835
00:27:45,799 --> 00:27:49,200
these took like 10 or 20 minutes to

836
00:27:47,399 --> 00:27:51,399
solve offline which is obviously

837
00:27:49,200 --> 00:27:52,760
terrible and not going to be real time

838
00:27:51,399 --> 00:27:54,039
so then you start asking the question

839
00:27:52,760 --> 00:27:55,720
okay I want to do this online I want to

840
00:27:54,039 --> 00:27:57,679
do it in real time what can we

841
00:27:55,720 --> 00:27:58,720
approximate from this thing try to speed

842
00:27:57,679 --> 00:28:01,159
it up

843
00:27:58,720 --> 00:28:04,120
without losing the core kind of flavor

844
00:28:01,159 --> 00:28:05,399
right so we start approximating things

845
00:28:04,120 --> 00:28:07,880
the the key Insight here is we want to

846
00:28:05,399 --> 00:28:10,399
keep this block structure and keep this

847
00:28:07,880 --> 00:28:11,399
overall sort of solver method where

848
00:28:10,399 --> 00:28:12,799
we're jointly solving all these

849
00:28:11,399 --> 00:28:14,519
optimization problems we're going to

850
00:28:12,799 --> 00:28:16,720
zoom inside each box and start

851
00:28:14,519 --> 00:28:18,120
approximating things inside the box so

852
00:28:16,720 --> 00:28:19,519
specifically in that optimal control

853
00:28:18,120 --> 00:28:20,399
problem instead of trying to solve it

854
00:28:19,519 --> 00:28:23,039
from scratch we're going to solve a

855
00:28:20,399 --> 00:28:24,760
tracking problem so that lets us locally

856
00:28:23,039 --> 00:28:27,080
approximate the Dynamics and everything

857
00:28:24,760 --> 00:28:28,720
around some reference that makes that

858
00:28:27,080 --> 00:28:32,399
easier

859
00:28:28,720 --> 00:28:33,919
um inside the Dynamics there we can loc

860
00:28:32,399 --> 00:28:35,120
it turns out we can locally linearize a

861
00:28:33,919 --> 00:28:37,120
bunch of stuff we're not linearizing

862
00:28:35,120 --> 00:28:40,159
anything about the contact Dynamics but

863
00:28:37,120 --> 00:28:41,440
like the sort of um manipulator dynamics

864
00:28:40,159 --> 00:28:43,000
of the robot right we can we can

865
00:28:41,440 --> 00:28:45,600
linearize a bunch of those about a

866
00:28:43,000 --> 00:28:47,440
reference do reference tracking uh we

867
00:28:45,600 --> 00:28:48,679
can also linearize the sign distance

868
00:28:47,440 --> 00:28:50,120
functions in this guy so we can

869
00:28:48,679 --> 00:28:51,000
approximate those in a way that's that's

870
00:28:50,120 --> 00:28:53,120
fast and

871
00:28:51,000 --> 00:28:55,960
cheap um and we can also approximate the

872
00:28:53,120 --> 00:28:57,360
friction cone and uh uh a way that's

873
00:28:55,960 --> 00:28:59,399
standard in robotics what sounds weird

874
00:28:57,360 --> 00:29:01,519
maybe at first so this is a it's a round

875
00:28:59,399 --> 00:29:04,360
cone right like an ice cream cone uh you

876
00:29:01,519 --> 00:29:06,559
can linearize this uh by approximated as

877
00:29:04,360 --> 00:29:08,519
a pyramid with flat faces that's another

878
00:29:06,559 --> 00:29:10,760
standard approximation uh you take an

879
00:29:08,519 --> 00:29:12,440
inner approximation Okay cool so we do

880
00:29:10,760 --> 00:29:13,720
all that stuff and then it turns out we

881
00:29:12,440 --> 00:29:15,240
can do this really fast so there's a

882
00:29:13,720 --> 00:29:17,279
couple examples so this is one we call

883
00:29:15,240 --> 00:29:18,320
the punch bot it's an inverted pendulum

884
00:29:17,279 --> 00:29:19,360
with a little arm and it can push

885
00:29:18,320 --> 00:29:22,320
against these

886
00:29:19,360 --> 00:29:24,399
walls and we've initialized this about

887
00:29:22,320 --> 00:29:26,039
that kind of balancing point with no

888
00:29:24,399 --> 00:29:28,080
other information so it I mean it

889
00:29:26,039 --> 00:29:29,880
obviously knows you know in there the GE

890
00:29:28,080 --> 00:29:31,120
omes in there so it kind of knows it can

891
00:29:29,880 --> 00:29:32,480
reach out and touch the walls but

892
00:29:31,120 --> 00:29:34,360
there's no information about you know

893
00:29:32,480 --> 00:29:36,640
contact modes or any of that in the

894
00:29:34,360 --> 00:29:38,720
problem uh it's linearized inverted

895
00:29:36,640 --> 00:29:40,320
pendulum Dynamics blah blah blah we hit

896
00:29:38,720 --> 00:29:41,760
this thing and it can kind of reach out

897
00:29:40,320 --> 00:29:43,799
and figure out how to balance this runs

898
00:29:41,760 --> 00:29:45,679
at a couple hundred Hertz um it's pretty

899
00:29:43,799 --> 00:29:47,320
good this one is one of my favorite and

900
00:29:45,679 --> 00:29:48,480
this is one like I actually saw this and

901
00:29:47,320 --> 00:29:50,960
was like okay this is actually going to

902
00:29:48,480 --> 00:29:52,640
work now so this is a quadruped model a

903
00:29:50,960 --> 00:29:54,200
dumb quadruped model we call the point

904
00:29:52,640 --> 00:29:57,840
foot model so it's a single rigid body

905
00:29:54,200 --> 00:30:00,399
with Point Mass feet and the reference

906
00:29:57,840 --> 00:30:02,080
in here that we gave this is trotting at

907
00:30:00,399 --> 00:30:04,440
the origin trotting in place at the

908
00:30:02,080 --> 00:30:06,760
origin so that's all it has it has this

909
00:30:04,440 --> 00:30:08,399
nice periodic linearization about the

910
00:30:06,760 --> 00:30:10,159
origin just doing that chop thing and

911
00:30:08,399 --> 00:30:12,080
then we just kick the crap out of it it

912
00:30:10,159 --> 00:30:14,120
flies through the air flails around

913
00:30:12,080 --> 00:30:16,279
lands on its feet figures out you know

914
00:30:14,120 --> 00:30:18,120
how to catch itself it reaches out a

915
00:30:16,279 --> 00:30:20,240
little bit and then it trots back to the

916
00:30:18,120 --> 00:30:22,799
origin all of this is coming out of a

917
00:30:20,240 --> 00:30:24,120
single linearization when I saw this you

918
00:30:22,799 --> 00:30:25,480
know I was I was like super because

919
00:30:24,120 --> 00:30:27,360
normally to get this kind of behavior

920
00:30:25,480 --> 00:30:29,960
out of standard methods there's a bunch

921
00:30:27,360 --> 00:30:31,679
of push recovery her istics right

922
00:30:29,960 --> 00:30:34,159
thinking about where to put your foot so

923
00:30:31,679 --> 00:30:36,360
that it sort of can arrest your fall and

924
00:30:34,159 --> 00:30:37,720
and cancel out your momentum all this

925
00:30:36,360 --> 00:30:39,559
kind of stuff this just comes right out

926
00:30:37,720 --> 00:30:41,399
of this so I don't know I thought this

927
00:30:39,559 --> 00:30:42,880
was really impressive and cool maybe

928
00:30:41,399 --> 00:30:44,120
it's not that impressive in light of you

929
00:30:42,880 --> 00:30:46,360
know things you've probably already seen

930
00:30:44,120 --> 00:30:48,159
right um okay so we we've done this on

931
00:30:46,360 --> 00:30:49,919
Hardware these are not you know amazing

932
00:30:48,159 --> 00:30:51,480
either but still kind of cool that this

933
00:30:49,919 --> 00:30:53,640
actually runs at real-time rates and

934
00:30:51,480 --> 00:30:56,360
it's totally you know there's no contact

935
00:30:53,640 --> 00:30:58,080
information pre-planned in here um and

936
00:30:56,360 --> 00:30:59,200
we started like messing around with you

937
00:30:58,080 --> 00:31:01,720
know if you can do this and you can

938
00:30:59,200 --> 00:31:02,960
reason about contacts all over the body

939
00:31:01,720 --> 00:31:04,960
most of the methods out there right now

940
00:31:02,960 --> 00:31:06,279
assume point contacts with the feet here

941
00:31:04,960 --> 00:31:07,480
we've got all the body geometry though

942
00:31:06,279 --> 00:31:08,559
so you can like do weird things with the

943
00:31:07,480 --> 00:31:10,399
rest of the body which is kind of

944
00:31:08,559 --> 00:31:12,279
interesting this is early stuff we've

945
00:31:10,399 --> 00:31:14,279
got better stuff now that um is not

946
00:31:12,279 --> 00:31:17,240
quite out yet so stay tuned doing some

947
00:31:14,279 --> 00:31:18,919
fun things with this um okay so that's

948
00:31:17,240 --> 00:31:21,200
kind of how we did this now I want to

949
00:31:18,919 --> 00:31:22,840
kind of like close up a little bit with

950
00:31:21,200 --> 00:31:25,919
part three what else can we do with all

951
00:31:22,840 --> 00:31:27,600
this stuff so there's actually there's a

952
00:31:25,919 --> 00:31:28,919
very rich set of connections between the

953
00:31:27,600 --> 00:31:30,960
stuff I just showed you and a whole

954
00:31:28,919 --> 00:31:32,720
bunch of other areas of optimization and

955
00:31:30,960 --> 00:31:34,679
whatever um so in

956
00:31:32,720 --> 00:31:36,039
particular uh this kind of problem

957
00:31:34,679 --> 00:31:37,639
formulation where we have all these

958
00:31:36,039 --> 00:31:40,679
coupled optimization problems that we

959
00:31:37,639 --> 00:31:42,000
solve jointly um does that look familiar

960
00:31:40,679 --> 00:31:44,760
to

961
00:31:42,000 --> 00:31:47,159
anybody so so this is exactly it turns

962
00:31:44,760 --> 00:31:49,960
out a nash game a Nash equilibrium from

963
00:31:47,159 --> 00:31:51,760
Game Theory which is a very very rich

964
00:31:49,960 --> 00:31:54,399
problem domain that we've dabbled in a

965
00:31:51,760 --> 00:31:55,679
bit to um it turns out I was doing this

966
00:31:54,399 --> 00:31:57,120
stuff for contact mechanics and I talked

967
00:31:55,679 --> 00:31:58,559
to someone who's a game theory person

968
00:31:57,120 --> 00:32:00,159
and then I realized oh wait all the

969
00:31:58,559 --> 00:32:01,519
solver tools we're building like

970
00:32:00,159 --> 00:32:02,960
actually solving Nash equilibrium

971
00:32:01,519 --> 00:32:05,200
problems actually so what we solve here

972
00:32:02,960 --> 00:32:06,760
is is what's called a uh generalized

973
00:32:05,200 --> 00:32:08,240
Nash equilibrium problem it's when you

974
00:32:06,760 --> 00:32:09,360
have a bunch of players and they all

975
00:32:08,240 --> 00:32:12,120
have constraints and they're trying to

976
00:32:09,360 --> 00:32:14,360
you know sort of do the best they can so

977
00:32:12,120 --> 00:32:16,159
that kind of weird stacked set of kkt

978
00:32:14,360 --> 00:32:17,360
conditions we write down is actually the

979
00:32:16,159 --> 00:32:18,960
conditions for a generalized Nash

980
00:32:17,360 --> 00:32:20,799
equilibrium so you do other cool things

981
00:32:18,960 --> 00:32:23,399
with that um we've played around with

982
00:32:20,799 --> 00:32:24,919
autonomous driving for this which is um

983
00:32:23,399 --> 00:32:26,679
you have a bunch of you know drivers and

984
00:32:24,919 --> 00:32:28,120
they're trying to negotiate you know

985
00:32:26,679 --> 00:32:30,279
merging on the highway for example has

986
00:32:28,120 --> 00:32:32,519
anyone heard of the Frozen robot problem

987
00:32:30,279 --> 00:32:33,559
it's a classic where if you have cars if

988
00:32:32,519 --> 00:32:35,880
you have an autonomous car with

989
00:32:33,559 --> 00:32:37,240
collision avoidance constraints in its

990
00:32:35,880 --> 00:32:39,559
sort of setup where it's not allowed to

991
00:32:37,240 --> 00:32:41,360
hit anybody if it's trying to merge into

992
00:32:39,559 --> 00:32:42,960
dense traffic bumper to- bumper traffic

993
00:32:41,360 --> 00:32:44,279
on the highway it'll just sit at the

994
00:32:42,960 --> 00:32:46,120
bottom of the off on ramp and just

995
00:32:44,279 --> 00:32:47,720
freeze and not go anywhere the reason

996
00:32:46,120 --> 00:32:49,039
this happens is it looks you know over

997
00:32:47,720 --> 00:32:50,399
there and it says there's not a space in

998
00:32:49,039 --> 00:32:52,600
between the cars big enough for me to

999
00:32:50,399 --> 00:32:54,159
fit through what do we do in that case

1000
00:32:52,600 --> 00:32:55,600
we're like oh well if I just kind of

1001
00:32:54,159 --> 00:32:57,240
nudge my way in there I'm going to force

1002
00:32:55,600 --> 00:32:58,799
the other drivers to make space for me

1003
00:32:57,240 --> 00:33:00,120
right but if you just have collision

1004
00:32:58,799 --> 00:33:02,120
avoidance constraints you can't reason

1005
00:33:00,120 --> 00:33:04,519
about that that's fundamentally sort of

1006
00:33:02,120 --> 00:33:05,799
a multi-agent game theoretic concept

1007
00:33:04,519 --> 00:33:08,919
right what you're doing there is

1008
00:33:05,799 --> 00:33:10,720
thinking about the other agents behavior

1009
00:33:08,919 --> 00:33:12,200
and kind of what they're going to do in

1010
00:33:10,720 --> 00:33:14,639
response to you right and that actually

1011
00:33:12,200 --> 00:33:16,120
is very naturally modeled by this uh

1012
00:33:14,639 --> 00:33:18,399
Nash equilibrium thing so we've done

1013
00:33:16,120 --> 00:33:20,240
that kind of stuff turns out also uh

1014
00:33:18,399 --> 00:33:23,200
under the framework we've kind of set up

1015
00:33:20,240 --> 00:33:26,159
here uh Falls a lot of classic robust

1016
00:33:23,200 --> 00:33:28,000
control stuff so Minx games stackle BG

1017
00:33:26,159 --> 00:33:29,480
equilibria all that kind of stuff also

1018
00:33:28,000 --> 00:33:31,320
falls into here and and we've done like

1019
00:33:29,480 --> 00:33:32,519
toy examples of that stuff where you're

1020
00:33:31,320 --> 00:33:33,679
sort of games against nature where you

1021
00:33:32,519 --> 00:33:35,399
have a disturbance input and you're

1022
00:33:33,679 --> 00:33:37,559
trying to make that's trying to make

1023
00:33:35,399 --> 00:33:39,000
your life bad and worse uh and then

1024
00:33:37,559 --> 00:33:40,480
you're trying to do the best you can in

1025
00:33:39,000 --> 00:33:41,760
spite of this worst case disturbance

1026
00:33:40,480 --> 00:33:43,960
stuff so these are like toy examples of

1027
00:33:41,760 --> 00:33:46,320
a rocket Landing with fluid slos model

1028
00:33:43,960 --> 00:33:47,600
that way they're kind of fun so lots of

1029
00:33:46,320 --> 00:33:49,000
interesting stuff there with like Game

1030
00:33:47,600 --> 00:33:51,240
Theory kind of stuff with this these

1031
00:33:49,000 --> 00:33:53,559
ideas um we've also dabbled a little bit

1032
00:33:51,240 --> 00:33:55,600
in manipulation stuff um and we're still

1033
00:33:53,559 --> 00:33:58,679
working on that this is kind of a fun

1034
00:33:55,600 --> 00:34:01,039
example where we um we took Collision

1035
00:33:58,679 --> 00:34:03,279
checking method that we have decall and

1036
00:34:01,039 --> 00:34:04,639
it turns out um if you do something like

1037
00:34:03,279 --> 00:34:06,880
this so I've always thought you know a

1038
00:34:04,639 --> 00:34:09,800
lot of the work in robotics decomposes

1039
00:34:06,880 --> 00:34:11,839
objects into meshes or uh a bunch of

1040
00:34:09,800 --> 00:34:14,280
like convex

1041
00:34:11,839 --> 00:34:15,520
um um sort of it does like a convex

1042
00:34:14,280 --> 00:34:17,520
decomposition where it breaks it into a

1043
00:34:15,520 --> 00:34:18,960
bunch of convex bodies or whatever and

1044
00:34:17,520 --> 00:34:21,359
to me this is always a little bit weird

1045
00:34:18,960 --> 00:34:22,800
in that you know the environment if I'm

1046
00:34:21,359 --> 00:34:24,679
going into a new space I don't know what

1047
00:34:22,800 --> 00:34:26,440
that stuff looks like a priority but the

1048
00:34:24,679 --> 00:34:28,320
robot I know what the robot looks like a

1049
00:34:26,440 --> 00:34:30,280
priority so we've done here is done this

1050
00:34:28,320 --> 00:34:33,359
convex decomposition thing offline for

1051
00:34:30,280 --> 00:34:35,040
the robot but then the new object in the

1052
00:34:33,359 --> 00:34:36,679
environment we're modeling with a point

1053
00:34:35,040 --> 00:34:38,240
Cloud which is kind of what you get

1054
00:34:36,679 --> 00:34:40,040
already out of your perception system

1055
00:34:38,240 --> 00:34:41,679
right so the idea here is this G call

1056
00:34:40,040 --> 00:34:44,079
thing parallelizes across all those

1057
00:34:41,679 --> 00:34:46,679
points super trivially we implemented it

1058
00:34:44,079 --> 00:34:50,079
on a on a GPU with Jacks and it turns

1059
00:34:46,679 --> 00:34:51,839
out we can do like 5,000 points in the

1060
00:34:50,079 --> 00:34:53,960
same amount of time as one by putting it

1061
00:34:51,839 --> 00:34:55,399
on a GPU so now we can have like 5,000

1062
00:34:53,960 --> 00:34:57,760
points on this bunny which has got a

1063
00:34:55,399 --> 00:34:59,119
really weird crazy non-convex geometry

1064
00:34:57,760 --> 00:35:01,880
and we can do it in real time because we

1065
00:34:59,119 --> 00:35:03,160
can solve for all the points in parallel

1066
00:35:01,880 --> 00:35:04,720
which is kind of cool and kind of I

1067
00:35:03,160 --> 00:35:07,240
think the idea here is to to try to get

1068
00:35:04,720 --> 00:35:09,240
ourselves closer to using the sensory

1069
00:35:07,240 --> 00:35:11,880
data that we are getting on these things

1070
00:35:09,240 --> 00:35:13,440
online in our simulations right so be

1071
00:35:11,880 --> 00:35:15,720
able to pull this kind of really complex

1072
00:35:13,440 --> 00:35:17,520
geometry natively just take that point

1073
00:35:15,720 --> 00:35:20,359
cloud with minimum minimal processing

1074
00:35:17,520 --> 00:35:22,119
and pull it right into your simulator um

1075
00:35:20,359 --> 00:35:23,720
and then kind of along these lines right

1076
00:35:22,119 --> 00:35:25,200
one of the things that i' I've kind of I

1077
00:35:23,720 --> 00:35:27,359
started started hearing people talk

1078
00:35:25,200 --> 00:35:29,480
about a bit more um we hear all this

1079
00:35:27,359 --> 00:35:31,760
kind of stff about the Sim toore Gap in

1080
00:35:29,480 --> 00:35:34,119
in robotics especially you know RL kind

1081
00:35:31,760 --> 00:35:35,480
of stuff um Sim to real transfer and how

1082
00:35:34,119 --> 00:35:38,000
you know errors in the simulator make

1083
00:35:35,480 --> 00:35:41,119
this harder um and it's always bothered

1084
00:35:38,000 --> 00:35:42,280
me we haven't seen so much real to sim

1085
00:35:41,119 --> 00:35:44,200
what classically we would have called

1086
00:35:42,280 --> 00:35:45,960
system ID in robotics with these

1087
00:35:44,200 --> 00:35:48,119
simulators where we kind of go do this

1088
00:35:45,960 --> 00:35:49,480
stuff on Hardware then rather doing than

1089
00:35:48,119 --> 00:35:51,839
doing like transfer learning where

1090
00:35:49,480 --> 00:35:53,359
you're trying to take your offline learn

1091
00:35:51,839 --> 00:35:55,040
policy and tweak it a little bit why

1092
00:35:53,359 --> 00:35:56,720
don't we take that same data and pump it

1093
00:35:55,040 --> 00:35:59,000
back into the simulator and try to

1094
00:35:56,720 --> 00:36:00,480
improve our models in the simulator so

1095
00:35:59,000 --> 00:36:01,599
we don't have to do that again next time

1096
00:36:00,480 --> 00:36:04,240
right so you can imagine all kinds of

1097
00:36:01,599 --> 00:36:07,280
stuff like actuator models compliance in

1098
00:36:04,240 --> 00:36:08,960
the robot weird friction effects um

1099
00:36:07,280 --> 00:36:11,440
maybe better geometry right all this

1100
00:36:08,960 --> 00:36:13,240
stuff we could be taking this Rich data

1101
00:36:11,440 --> 00:36:15,480
and pulling it back in and making our

1102
00:36:13,240 --> 00:36:16,520
our simulator making our models better

1103
00:36:15,480 --> 00:36:18,480
uh and particularly the

1104
00:36:16,520 --> 00:36:20,000
differentiability of this whole pipeline

1105
00:36:18,480 --> 00:36:22,319
enables this right I can just do normal

1106
00:36:20,000 --> 00:36:23,200
lease squares kind of stuff on the data

1107
00:36:22,319 --> 00:36:24,160
because I can diff through the whole

1108
00:36:23,200 --> 00:36:27,880
simulator

1109
00:36:24,160 --> 00:36:29,760
pipeline okay and then uh last thing to

1110
00:36:27,880 --> 00:36:32,520
briefly is this kind of idea this like

1111
00:36:29,760 --> 00:36:33,599
data driven kind of Sid control stuff we

1112
00:36:32,520 --> 00:36:36,000
we've actually started doing this

1113
00:36:33,599 --> 00:36:38,440
recently with um a few collaborators in

1114
00:36:36,000 --> 00:36:40,520
Quantum Computing it turns out the

1115
00:36:38,440 --> 00:36:41,800
making cubits work it turns out is hard

1116
00:36:40,520 --> 00:36:43,560
and the models are bad right and there's

1117
00:36:41,800 --> 00:36:45,040
lots of noise so we started doing this

1118
00:36:43,560 --> 00:36:47,920
sort of thing on these Cubit systems

1119
00:36:45,040 --> 00:36:49,480
with some cabers um a quantum computer

1120
00:36:47,920 --> 00:36:51,440
that one of our collaborators Dave

1121
00:36:49,480 --> 00:36:52,480
Schuster who's at Stanford now has that

1122
00:36:51,440 --> 00:36:55,640
we've actually run these kind of

1123
00:36:52,480 --> 00:36:58,040
algorithms on and sort of improved the

1124
00:36:55,640 --> 00:36:59,800
gate fidelities on these systems

1125
00:36:58,040 --> 00:37:01,280
um by quite a lot and I think we're

1126
00:36:59,800 --> 00:37:03,280
we're hitting kind of state-of-the-art

1127
00:37:01,280 --> 00:37:07,640
fidelities now in this Quantum Gates

1128
00:37:03,280 --> 00:37:09,520
kind of cool um okay with that um I have

1129
00:37:07,640 --> 00:37:11,839
been extremely lucky to have all these

1130
00:37:09,520 --> 00:37:13,920
really awesome students uh work with me

1131
00:37:11,839 --> 00:37:15,400
over the last five years or so who

1132
00:37:13,920 --> 00:37:18,480
really done all the stuff I just showed

1133
00:37:15,400 --> 00:37:20,599
you um and uh that's that's who makes

1134
00:37:18,480 --> 00:37:24,319
all the magic happen so thanks to all

1135
00:37:20,599 --> 00:37:25,520
these guys and um yeah this is how you

1136
00:37:24,319 --> 00:37:28,839
can find me if you want to harass me

1137
00:37:25,520 --> 00:37:30,200
some more and uh I'm happy happy to chat

1138
00:37:28,839 --> 00:37:32,450
more whatever you guys want to do right

1139
00:37:30,200 --> 00:37:35,580
now

1140
00:37:32,450 --> 00:37:35,580
[Applause]

