1
00:00:06,319 --> 00:00:10,960
We're actually going to have uh Yakir uh

2
00:00:08,639 --> 00:00:12,719
speaking up next and he's going to be

3
00:00:10,960 --> 00:00:14,639
talking about powerful and accurate case

4
00:00:12,719 --> 00:00:17,840
control analysis of spatially resolved

5
00:00:14,639 --> 00:00:19,680
molecular data. Um so thank you for the

6
00:00:17,840 --> 00:00:21,700
flexibility. Thanksir and let's welcome

7
00:00:19,680 --> 00:00:25,279
him up.

8
00:00:21,700 --> 00:00:29,119
[Applause]

9
00:00:25,279 --> 00:00:30,800
All right. Uh thanks. So I'm a computer

10
00:00:29,119 --> 00:00:32,640
scientist and a physician who sees

11
00:00:30,800 --> 00:00:34,719
patients with autoimmune disease. I work

12
00:00:32,640 --> 00:00:36,079
in the Ray Chadri lab here in Boston.

13
00:00:34,719 --> 00:00:37,840
And I want to tell you about a method

14
00:00:36,079 --> 00:00:40,239
we've developed for finding disease

15
00:00:37,840 --> 00:00:43,040
associations in spatial data. As has

16
00:00:40,239 --> 00:00:45,120
been already described, spatial data are

17
00:00:43,040 --> 00:00:46,640
advancing very fast. We can now profile

18
00:00:45,120 --> 00:00:48,160
really quite large numbers of proteins

19
00:00:46,640 --> 00:00:50,800
and genes at very high spatial

20
00:00:48,160 --> 00:00:52,320
resolution. And as you've already seen,

21
00:00:50,800 --> 00:00:53,600
this has been a really rich area for

22
00:00:52,320 --> 00:00:55,039
methods development. And there are some

23
00:00:53,600 --> 00:00:56,879
really sophisticated approaches now for

24
00:00:55,039 --> 00:01:00,399
analyzing spatial data. many of which

25
00:00:56,879 --> 00:01:01,920
use advanced ML approaches. Um, and

26
00:01:00,399 --> 00:01:04,000
thanks to these methods such as what

27
00:01:01,920 --> 00:01:06,320
Donna just showed you, we can now

28
00:01:04,000 --> 00:01:07,920
annotate tissue at really, you know, we

29
00:01:06,320 --> 00:01:10,560
parse out tissue structure really in

30
00:01:07,920 --> 00:01:12,240
quite granular detail. Today I want to

31
00:01:10,560 --> 00:01:14,080
talk specifically about finding disease

32
00:01:12,240 --> 00:01:16,400
associated spatial structures and I want

33
00:01:14,080 --> 00:01:18,560
to do this in a statistical framework.

34
00:01:16,400 --> 00:01:21,320
Given a spatial data set with many case

35
00:01:18,560 --> 00:01:23,280
samples and many case and many control

36
00:01:21,320 --> 00:01:24,960
samples, are there patterns that are

37
00:01:23,280 --> 00:01:26,720
statistically significantly different

38
00:01:24,960 --> 00:01:29,360
between cases and controls after

39
00:01:26,720 --> 00:01:30,960
multiple testing correction? And while

40
00:01:29,360 --> 00:01:33,119
it might seem like our ability to

41
00:01:30,960 --> 00:01:34,799
successfully parse out JHU structures

42
00:01:33,119 --> 00:01:37,360
and spatial data should translate

43
00:01:34,799 --> 00:01:39,280
intuitively into wellpowered statistical

44
00:01:37,360 --> 00:01:40,640
case control analysis, we found that

45
00:01:39,280 --> 00:01:42,400
these are actually two quite distinct

46
00:01:40,640 --> 00:01:44,240
problems. There's issues like batch

47
00:01:42,400 --> 00:01:45,759
effects and finding flexible

48
00:01:44,240 --> 00:01:47,119
representations at the sample level that

49
00:01:45,759 --> 00:01:48,560
allow samples to be compared to each

50
00:01:47,119 --> 00:01:50,640
other. These are crucial for case

51
00:01:48,560 --> 00:01:52,159
control analysis. And so even though

52
00:01:50,640 --> 00:01:54,000
some existing methods have been used in

53
00:01:52,159 --> 00:01:55,600
a case control setting, it wasn't clear

54
00:01:54,000 --> 00:01:57,000
to us how effective we should expect

55
00:01:55,600 --> 00:01:59,200
them to be in

56
00:01:57,000 --> 00:02:00,719
general. To look at this, we used

57
00:01:59,200 --> 00:02:02,000
several existing tissue annotation

58
00:02:00,719 --> 00:02:04,399
methods to analyze a spatial

59
00:02:02,000 --> 00:02:06,479
transcrytoics data set of 75 brain

60
00:02:04,399 --> 00:02:08,959
samples from 27 donors in a dementia

61
00:02:06,479 --> 00:02:11,360
cohort. Now, doing benchmarking of this

62
00:02:08,959 --> 00:02:13,120
type is challenging. uh not all the

63
00:02:11,360 --> 00:02:14,400
methods necessarily output p values.

64
00:02:13,120 --> 00:02:16,400
Some of them don't even allow multiple

65
00:02:14,400 --> 00:02:18,080
samples as input. So what we did was we

66
00:02:16,400 --> 00:02:20,160
chose five methods that were efficiently

67
00:02:18,080 --> 00:02:22,160
runnable on a data set of this modality

68
00:02:20,160 --> 00:02:24,560
and sample size and we used each of them

69
00:02:22,160 --> 00:02:26,160
in this standard way. So for each method

70
00:02:24,560 --> 00:02:28,400
we annotated all the samples at the

71
00:02:26,160 --> 00:02:29,520
level of small spatial neighborhoods. We

72
00:02:28,400 --> 00:02:30,640
then merged all the spatial

73
00:02:29,520 --> 00:02:32,800
neighborhoods across samples and

74
00:02:30,640 --> 00:02:35,040
clustered them. And then we tested each

75
00:02:32,800 --> 00:02:36,800
cluster for basically whether it was

76
00:02:35,040 --> 00:02:38,400
over represented in cases compared to

77
00:02:36,800 --> 00:02:39,959
controls or vice versa and then

78
00:02:38,400 --> 00:02:42,319
accounted for multiple

79
00:02:39,959 --> 00:02:44,319
testing. In this data set, we were

80
00:02:42,319 --> 00:02:45,760
unable to use existing tissue annotation

81
00:02:44,319 --> 00:02:48,000
methods to sort of adapt them in this

82
00:02:45,760 --> 00:02:49,920
way to find a case control signal. This

83
00:02:48,000 --> 00:02:51,760
bar chart shows the log P value we got

84
00:02:49,920 --> 00:02:53,280
with each method and the dash line is

85
00:02:51,760 --> 00:02:55,200
the significance threshold. And

86
00:02:53,280 --> 00:02:57,120
paradoxically, the more sophisticated

87
00:02:55,200 --> 00:02:59,120
methods on the right actually maybe do

88
00:02:57,120 --> 00:03:00,800
even a little bit worse than the simple

89
00:02:59,120 --> 00:03:02,400
baselines on the left, which just

90
00:03:00,800 --> 00:03:04,560
represent each spatial neighborhood

91
00:03:02,400 --> 00:03:06,760
using its average expression profile or

92
00:03:04,560 --> 00:03:09,440
its cell type abundance

93
00:03:06,760 --> 00:03:10,959
profile. And as I'll get to later, this

94
00:03:09,440 --> 00:03:12,640
data set does contain case control

95
00:03:10,959 --> 00:03:14,159
signals. We found those signals using

96
00:03:12,640 --> 00:03:15,360
the method we developed, which takes a

97
00:03:14,159 --> 00:03:16,840
bit of a different approach that I'd

98
00:03:15,360 --> 00:03:19,519
like to describe to

99
00:03:16,840 --> 00:03:21,360
you. Our method is called variational

100
00:03:19,519 --> 00:03:23,360
inference-based micron analysis or

101
00:03:21,360 --> 00:03:25,159
Vimma. And in developing it, there were

102
00:03:23,360 --> 00:03:27,519
two key intuitions that we tried to

103
00:03:25,159 --> 00:03:29,360
incorporate. First, if embeddings of

104
00:03:27,519 --> 00:03:31,440
spatial neighborhoods are dominated by

105
00:03:29,360 --> 00:03:34,239
batch effects, then case control signal

106
00:03:31,440 --> 00:03:35,760
might be obscured. And second, if tissue

107
00:03:34,239 --> 00:03:37,519
regions are forced into mutually

108
00:03:35,760 --> 00:03:39,680
exclusive clusters, then case control

109
00:03:37,519 --> 00:03:41,440
signal might also be obscured because

110
00:03:39,680 --> 00:03:44,239
the reality of the tissue biology might

111
00:03:41,440 --> 00:03:46,319
be richer than that. So here's how we

112
00:03:44,239 --> 00:03:48,080
operationalize these intuitions. First,

113
00:03:46,319 --> 00:03:50,000
we take each sample, we split it up into

114
00:03:48,080 --> 00:03:51,360
patches, and then we take those patches

115
00:03:50,000 --> 00:03:52,879
and feed them into a variational

116
00:03:51,360 --> 00:03:54,799
autoenccoder to learn a latent

117
00:03:52,879 --> 00:03:56,400
representation of the patches, treating

118
00:03:54,799 --> 00:03:58,640
the patches as simple images, sort of

119
00:03:56,400 --> 00:04:00,080
pixel level representation. Um, this is

120
00:03:58,640 --> 00:04:01,280
in keeping with, I think, many, you

121
00:04:00,080 --> 00:04:04,319
know, some themes that you guys have

122
00:04:01,280 --> 00:04:05,840
seen today already. But we found that

123
00:04:04,319 --> 00:04:07,760
when we used a vanilla variational

124
00:04:05,840 --> 00:04:09,519
autoenccoder, the embeddings were really

125
00:04:07,760 --> 00:04:10,959
heavily influenced by just which sample

126
00:04:09,519 --> 00:04:12,560
a tissue batch came from. They're

127
00:04:10,959 --> 00:04:14,319
basically capturing a lot of technical

128
00:04:12,560 --> 00:04:16,000
variation in addition to the biological

129
00:04:14,319 --> 00:04:17,880
variation that we were after, even when

130
00:04:16,000 --> 00:04:20,079
we did aggressive batch correction

131
00:04:17,880 --> 00:04:21,759
upstream. To solve this, we made our

132
00:04:20,079 --> 00:04:23,520
autoenccoder into a conditional

133
00:04:21,759 --> 00:04:25,280
variational autoenccoder, meaning that

134
00:04:23,520 --> 00:04:27,120
both the encoder and decoder are given

135
00:04:25,280 --> 00:04:28,639
access to sample information to sample

136
00:04:27,120 --> 00:04:30,320
ID. And together with the variational

137
00:04:28,639 --> 00:04:32,400
penalty, this basically encourages the

138
00:04:30,320 --> 00:04:34,400
encoder and decoder to remove technical

139
00:04:32,400 --> 00:04:36,320
artifacts from the latent space. This

140
00:04:34,400 --> 00:04:38,720
technique isn't new. It was used by a

141
00:04:36,320 --> 00:04:40,560
nearsef and the SCVI team who used it in

142
00:04:38,720 --> 00:04:42,440
the single cell space. And here it made

143
00:04:40,560 --> 00:04:45,199
a really big difference for

144
00:04:42,440 --> 00:04:46,800
us. The second innovation in Vimma

145
00:04:45,199 --> 00:04:49,199
relates to how we do the case control

146
00:04:46,800 --> 00:04:51,120
association test. Here we compute a

147
00:04:49,199 --> 00:04:52,880
nearest neighbor graph of the patches

148
00:04:51,120 --> 00:04:55,040
using the patch embeddings, but we don't

149
00:04:52,880 --> 00:04:56,479
then cluster the patches into you know

150
00:04:55,040 --> 00:04:58,960
what people might colloquially call

151
00:04:56,479 --> 00:05:01,120
niches. uh in the field right now.

152
00:04:58,960 --> 00:05:02,960
Instead, we define for each patch what

153
00:05:01,120 --> 00:05:04,639
we call a microniche which is composed

154
00:05:02,960 --> 00:05:05,919
of patches that are close to that patch

155
00:05:04,639 --> 00:05:07,039
in the nearest neighbor graph and

156
00:05:05,919 --> 00:05:09,440
ideally come from many different

157
00:05:07,039 --> 00:05:11,280
samples. Belonging in these micro

158
00:05:09,440 --> 00:05:13,280
belonging in these microniches can be

159
00:05:11,280 --> 00:05:14,960
fractional and the micrones can overlap.

160
00:05:13,280 --> 00:05:16,960
So the idea here is really to build a

161
00:05:14,960 --> 00:05:18,320
redundant and flexible representation of

162
00:05:16,960 --> 00:05:20,639
what's going on in each part of the

163
00:05:18,320 --> 00:05:22,400
graph. We then represent each sample

164
00:05:20,639 --> 00:05:24,000
using the abundances in that sample of

165
00:05:22,400 --> 00:05:25,440
all the microniches in the data set and

166
00:05:24,000 --> 00:05:27,120
we find the case control signal by

167
00:05:25,440 --> 00:05:29,759
testing each microniche for association

168
00:05:27,120 --> 00:05:32,880
to case control status across samples.

169
00:05:29,759 --> 00:05:34,800
The result is uh does this work? Yeah,

170
00:05:32,880 --> 00:05:36,479
you know an overall p value for the

171
00:05:34,800 --> 00:05:38,240
presence of an association in general

172
00:05:36,479 --> 00:05:39,759
and then also a measure of statistical

173
00:05:38,240 --> 00:05:42,080
significance at the level of each

174
00:05:39,759 --> 00:05:44,479
microniche that tells us whether that

175
00:05:42,080 --> 00:05:45,840
microniche is not significantly

176
00:05:44,479 --> 00:05:47,759
different between cases and controls.

177
00:05:45,840 --> 00:05:49,199
those are in gray significantly enriched

178
00:05:47,759 --> 00:05:50,800
in cases those are in red and

179
00:05:49,199 --> 00:05:52,600
significantly enriched in controls those

180
00:05:50,800 --> 00:05:54,560
are in

181
00:05:52,600 --> 00:05:56,560
blue there are a lot of technical

182
00:05:54,560 --> 00:05:57,919
details I'm eliting here for instance

183
00:05:56,560 --> 00:05:59,520
you have to contend with the fact that

184
00:05:57,919 --> 00:06:01,280
there's usually tens of thousands or

185
00:05:59,520 --> 00:06:02,720
more of microniches this can hurt

186
00:06:01,280 --> 00:06:04,319
statistical power because it makes

187
00:06:02,720 --> 00:06:05,440
things really high dimensional you also

188
00:06:04,319 --> 00:06:07,360
have to think about how to get rigorous

189
00:06:05,440 --> 00:06:08,800
p values in a way that accounts for the

190
00:06:07,360 --> 00:06:10,800
existence of technical replicates which

191
00:06:08,800 --> 00:06:12,720
are very common in spatial data and also

192
00:06:10,800 --> 00:06:14,080
the possibility of other sample level

193
00:06:12,720 --> 00:06:16,639
confounders that you might might want to

194
00:06:14,080 --> 00:06:18,400
correct for our method does have some

195
00:06:16,639 --> 00:06:20,160
nice features. Uh first, it's fast. It

196
00:06:18,400 --> 00:06:22,240
takes just a few hours to compute even

197
00:06:20,160 --> 00:06:24,319
on the large uh dementia data set that I

198
00:06:22,240 --> 00:06:26,000
described. Uh it doesn't require cell

199
00:06:24,319 --> 00:06:28,000
segmentation. So it's applicable easily

200
00:06:26,000 --> 00:06:29,680
to many different kinds of to really any

201
00:06:28,000 --> 00:06:33,360
kind of sufficiently high resolution

202
00:06:29,680 --> 00:06:34,800
spatial data. Uh and it doesn't require

203
00:06:33,360 --> 00:06:36,000
extensive hyperparameter tuning. And

204
00:06:34,800 --> 00:06:37,600
you'll see in the examples I'll show

205
00:06:36,000 --> 00:06:38,960
here across many different modalities,

206
00:06:37,600 --> 00:06:41,280
we were able to run this method with

207
00:06:38,960 --> 00:06:42,720
identical hyperparameters.

208
00:06:41,280 --> 00:06:43,520
And I won't show this here, but you

209
00:06:42,720 --> 00:06:45,280
know, because we're thinking

210
00:06:43,520 --> 00:06:46,960
statistically, we did do simulations to

211
00:06:45,280 --> 00:06:48,319
make sure that the p values this method

212
00:06:46,960 --> 00:06:51,120
gives are well calibrated. You know,

213
00:06:48,319 --> 00:06:52,560
that 0.05 really means 0.05 and so on.

214
00:06:51,120 --> 00:06:54,080
Uh, and we verified that the method is

215
00:06:52,560 --> 00:06:56,000
well powered and that it accurately

216
00:06:54,080 --> 00:06:57,120
identifies the parts of each sample that

217
00:06:56,000 --> 00:06:59,479
contribute to the case control

218
00:06:57,120 --> 00:07:02,240
association or the case control

219
00:06:59,479 --> 00:07:03,840
signal. We applied our method to three

220
00:07:02,240 --> 00:07:05,280
data sets that I want to show you here

221
00:07:03,840 --> 00:07:07,440
briefly spanning three really different

222
00:07:05,280 --> 00:07:09,120
modalities. um all the way going all the

223
00:07:07,440 --> 00:07:11,160
way from simple immunohysic chemistry to

224
00:07:09,120 --> 00:07:13,280
to murfish you know which is spatial

225
00:07:11,160 --> 00:07:15,199
transcrytoics the first data set is the

226
00:07:13,280 --> 00:07:17,520
dementia data set that I described uh

227
00:07:15,199 --> 00:07:20,319
and this is the result of the vimma

228
00:07:17,520 --> 00:07:22,240
analysis of that data set so in this uh

229
00:07:20,319 --> 00:07:25,039
picture what you're seeing is a um where

230
00:07:22,240 --> 00:07:27,440
every point is a patch and the red

231
00:07:25,039 --> 00:07:30,080
points are patches whose microniches are

232
00:07:27,440 --> 00:07:31,280
expanded in the dementia samples and the

233
00:07:30,080 --> 00:07:32,720
blue points are patches whose

234
00:07:31,280 --> 00:07:35,039
microniches are expanded in the

235
00:07:32,720 --> 00:07:36,240
controls. Now when we saw this we the

236
00:07:35,039 --> 00:07:38,000
first question we wondered was what does

237
00:07:36,240 --> 00:07:39,680
this look like at the sample level? Like

238
00:07:38,000 --> 00:07:41,280
is this a signal that is maybe

239
00:07:39,680 --> 00:07:42,880
significant statistically but rather

240
00:07:41,280 --> 00:07:44,319
weak? Is it a signal that's really

241
00:07:42,880 --> 00:07:45,840
driven by a small minority of the

242
00:07:44,319 --> 00:07:48,560
samples or something like that? And so

243
00:07:45,840 --> 00:07:49,840
to get at that what we did was um look

244
00:07:48,560 --> 00:07:51,520
at the fact that every sample in

245
00:07:49,840 --> 00:07:52,720
principle can contain patches of all

246
00:07:51,520 --> 00:07:54,319
three kinds right every sample can have

247
00:07:52,720 --> 00:07:56,479
blue patches, gray patches or red

248
00:07:54,319 --> 00:07:58,560
patches. uh and so we wondered whether

249
00:07:56,479 --> 00:08:00,879
the relative proportions of blue patches

250
00:07:58,560 --> 00:08:02,479
and red patches in each sample could you

251
00:08:00,879 --> 00:08:04,879
know how how closely they relate to the

252
00:08:02,479 --> 00:08:07,120
true phenotype label of that sample. So

253
00:08:04,879 --> 00:08:09,520
what you're seeing here is uh a plot in

254
00:08:07,120 --> 00:08:11,120
which each dot is now a sample and this

255
00:08:09,520 --> 00:08:13,039
is what we're measuring. The y- axis is

256
00:08:11,120 --> 00:08:14,720
the fraction of patches in each sample

257
00:08:13,039 --> 00:08:16,400
that come from these red dots. The

258
00:08:14,720 --> 00:08:17,520
x-axis is the fraction of patches in

259
00:08:16,400 --> 00:08:19,520
each sample that come from the blue

260
00:08:17,520 --> 00:08:22,080
dots. And then the color of these dots

261
00:08:19,520 --> 00:08:24,160
is the true phenotype of those samples.

262
00:08:22,080 --> 00:08:25,680
And so what we see is this really is a

263
00:08:24,160 --> 00:08:27,039
signal that's robust and sort of exists

264
00:08:25,680 --> 00:08:29,199
across the data set across all the

265
00:08:27,039 --> 00:08:32,080
samples and uh and is able to separate

266
00:08:29,199 --> 00:08:34,560
cases from controls quite well. What are

267
00:08:32,080 --> 00:08:35,519
these patches though? Uh to look at that

268
00:08:34,560 --> 00:08:37,279
I want to show you a different view of

269
00:08:35,519 --> 00:08:39,159
the data set which is a spatial view. So

270
00:08:37,279 --> 00:08:41,279
now you're seeing a subset of the

271
00:08:39,159 --> 00:08:43,279
samples. Uh and they're sort of arrayed

272
00:08:41,279 --> 00:08:45,200
in space. And in each sample I've

273
00:08:43,279 --> 00:08:47,680
indicated uh some some of the cortical

274
00:08:45,200 --> 00:08:49,279
layers. Uh so cortical layer 2 three or

275
00:08:47,680 --> 00:08:51,440
cortical layers 2 three are indicated in

276
00:08:49,279 --> 00:08:53,600
green. cortical layer six is indicated

277
00:08:51,440 --> 00:08:56,000
in blue. And the reason I'm doing this

278
00:08:53,600 --> 00:08:58,000
is because when we overlay the control

279
00:08:56,000 --> 00:08:59,760
associated patches onto this image, so

280
00:08:58,000 --> 00:09:01,360
now they're outlined in blue. What we

281
00:08:59,760 --> 00:09:03,920
see is that they correspond really

282
00:09:01,360 --> 00:09:05,680
cleanly to the to cortical layers two

283
00:09:03,920 --> 00:09:07,920
and three. And this turns out to

284
00:09:05,680 --> 00:09:09,600
actually be a known thing. Um thickness

285
00:09:07,920 --> 00:09:10,880
of cortical layer 3 has been associated

286
00:09:09,600 --> 00:09:12,160
with cognitive ability, you know,

287
00:09:10,880 --> 00:09:14,560
positively associated with cognitive

288
00:09:12,160 --> 00:09:16,640
ability in neuroiming studies. Um it's

289
00:09:14,560 --> 00:09:18,519
been negatively associated with dementia

290
00:09:16,640 --> 00:09:21,120
uh in single cell studies.

291
00:09:18,519 --> 00:09:22,560
So, excuse me. This is an example where

292
00:09:21,120 --> 00:09:24,720
our method is recovering something that

293
00:09:22,560 --> 00:09:26,000
we already know. Uh, and it's, you know,

294
00:09:24,720 --> 00:09:27,600
and it makes us happy that our method is

295
00:09:26,000 --> 00:09:29,279
finding things that are known. Um,

296
00:09:27,600 --> 00:09:31,120
certainly, uh, in a scenario where that

297
00:09:29,279 --> 00:09:33,200
maybe wasn't obvious that it would, uh,

298
00:09:31,120 --> 00:09:35,279
work out with this modality. What about

299
00:09:33,200 --> 00:09:38,160
the dementia associated patches? Well,

300
00:09:35,279 --> 00:09:40,160
they uh, overlay like this. So, they

301
00:09:38,160 --> 00:09:41,680
correspond to a subset of layer 6, not

302
00:09:40,160 --> 00:09:43,600
the whole thing, but a subset. And so,

303
00:09:41,680 --> 00:09:45,360
the first question that we asked is

304
00:09:43,600 --> 00:09:47,279
like, is this subset biologically

305
00:09:45,360 --> 00:09:49,519
meaningful? Is it different in any way

306
00:09:47,279 --> 00:09:51,200
from the rest of the cortical layer 6 or

307
00:09:49,519 --> 00:09:52,880
are we just sort of finding some random

308
00:09:51,200 --> 00:09:54,160
subset of layer six because we're not,

309
00:09:52,880 --> 00:09:56,800
you know, because of some statistical

310
00:09:54,160 --> 00:09:58,800
power issue. And so to get at this, we

311
00:09:56,800 --> 00:10:00,640
looked at cell type abundances in these

312
00:09:58,800 --> 00:10:02,480
in the basically the the red outlined

313
00:10:00,640 --> 00:10:04,160
patches compared to the rest of layer 6.

314
00:10:02,480 --> 00:10:06,000
And that's what you're seeing here. So

315
00:10:04,160 --> 00:10:08,160
for a subset of the cells, what I'm

316
00:10:06,000 --> 00:10:10,000
showing you is the distribution of the

317
00:10:08,160 --> 00:10:12,720
abundances of these cell types across

318
00:10:10,000 --> 00:10:14,320
the um dementia associated layer six

319
00:10:12,720 --> 00:10:16,800
patches. That's the red histogram on the

320
00:10:14,320 --> 00:10:18,240
right versus the non-dementia associated

321
00:10:16,800 --> 00:10:19,839
layer 6 patches. That's the histogram on

322
00:10:18,240 --> 00:10:21,839
the left. And you see that some cell

323
00:10:19,839 --> 00:10:23,519
types really don't change much like L6B.

324
00:10:21,839 --> 00:10:25,680
This is a neuronal cell type that lives

325
00:10:23,519 --> 00:10:27,600
in cortical layer 6. It's basically

326
00:10:25,680 --> 00:10:29,360
identically distributed between what

327
00:10:27,600 --> 00:10:31,200
Vimma picked out as dementia associated

328
00:10:29,360 --> 00:10:33,120
and the rest of layer 6. But other cell

329
00:10:31,200 --> 00:10:34,640
types like oligodites show really quite

330
00:10:33,120 --> 00:10:36,560
large differences between the patches

331
00:10:34,640 --> 00:10:38,399
that Vimma picked out as being typical

332
00:10:36,560 --> 00:10:40,720
of dementia in layer 6 and the rest of

333
00:10:38,399 --> 00:10:42,640
layer 6. And you know this is

334
00:10:40,720 --> 00:10:45,040
interesting because uh there's actually

335
00:10:42,640 --> 00:10:46,880
work uh you know current work uh from

336
00:10:45,040 --> 00:10:48,079
Evan Costco here at the broad and others

337
00:10:46,880 --> 00:10:50,240
talking about the potential role of

338
00:10:48,079 --> 00:10:51,839
oligodenderites in Alzheimer's uh

339
00:10:50,240 --> 00:10:53,600
theorizing that they might actually play

340
00:10:51,839 --> 00:10:54,959
a role in producing amaloid. Obviously

341
00:10:53,600 --> 00:10:56,480
it's quite speculative for me to say

342
00:10:54,959 --> 00:10:57,839
that that's what these oligodendrites

343
00:10:56,480 --> 00:10:59,600
are doing but nevertheless this was an

344
00:10:57,839 --> 00:11:01,279
exciting example to us because it's

345
00:10:59,600 --> 00:11:03,360
showing a case where vimma is finding a

346
00:11:01,279 --> 00:11:04,720
relatively granular association uh and

347
00:11:03,360 --> 00:11:06,240
it's doing it where you know in a place

348
00:11:04,720 --> 00:11:08,240
where other methods were unable to do

349
00:11:06,240 --> 00:11:10,320
so.

350
00:11:08,240 --> 00:11:12,160
The second data set uh is a codex data

351
00:11:10,320 --> 00:11:14,560
set in ulcerative colitis and I'll speak

352
00:11:12,160 --> 00:11:16,959
briefly about it. Uh what we you know

353
00:11:14,560 --> 00:11:18,079
the signal I'm sort of the the most uh I

354
00:11:16,959 --> 00:11:20,160
don't know excited about from this data

355
00:11:18,079 --> 00:11:22,079
set is is a signal of TNF inhibition

356
00:11:20,160 --> 00:11:23,279
versus not. So TNF inhibition is the

357
00:11:22,079 --> 00:11:24,880
dominant treatment modality in this

358
00:11:23,279 --> 00:11:26,160
disease. And we were able to find

359
00:11:24,880 --> 00:11:27,600
basically a spatial signature that

360
00:11:26,160 --> 00:11:30,640
corresponds to whether patients are on a

361
00:11:27,600 --> 00:11:32,640
TNF inhibitor or not. And when we looked

362
00:11:30,640 --> 00:11:35,040
at the micrones driving this association

363
00:11:32,640 --> 00:11:37,279
we saw a very striking pattern. So these

364
00:11:35,040 --> 00:11:38,880
patches here that uh vimma annotates as

365
00:11:37,279 --> 00:11:41,200
being typical of patients who are not on

366
00:11:38,880 --> 00:11:42,720
a TNF inhibitor they have uh you know

367
00:11:41,200 --> 00:11:44,320
this sort of stereotype pattern of

368
00:11:42,720 --> 00:11:46,640
clumps of B cells that's the red

369
00:11:44,320 --> 00:11:48,000
staining here surrounded by uh T- cells

370
00:11:46,640 --> 00:11:49,920
here in green these are basically

371
00:11:48,000 --> 00:11:52,000
lymphoid aggregates and these lymphoid

372
00:11:49,920 --> 00:11:53,760
aggregates are completely absent in the

373
00:11:52,000 --> 00:11:57,839
cells that are annotated by vimma as

374
00:11:53,760 --> 00:11:59,920
being typical of TNF inhibition. Um when

375
00:11:57,839 --> 00:12:01,279
we again tried to you know we wanted to

376
00:11:59,920 --> 00:12:03,200
get a sense of how strong of an effect

377
00:12:01,279 --> 00:12:04,560
this was uh we made the same kind of

378
00:12:03,200 --> 00:12:06,959
plot that I showed you in the dementia

379
00:12:04,560 --> 00:12:09,200
example where each dot is a sample and

380
00:12:06,959 --> 00:12:11,040
on the y-axis is the fraction of patches

381
00:12:09,200 --> 00:12:13,200
in each sample that come from this type

382
00:12:11,040 --> 00:12:14,800
of category and on the x- axis is a

383
00:12:13,200 --> 00:12:17,120
fraction of patches that come from here

384
00:12:14,800 --> 00:12:19,120
that are uh typical of the TNF naive

385
00:12:17,120 --> 00:12:22,320
state and then we colored each sample by

386
00:12:19,120 --> 00:12:23,920
how much TNF exposure each patient h had

387
00:12:22,320 --> 00:12:26,079
uh and what we see is a really nice dose

388
00:12:23,920 --> 00:12:27,440
response relationship basically uh these

389
00:12:26,079 --> 00:12:29,200
you know, these two types of patches are

390
00:12:27,440 --> 00:12:30,399
separating uh patients that have never

391
00:12:29,200 --> 00:12:32,880
been on a TNF from patients that have

392
00:12:30,399 --> 00:12:35,680
been on a TNF inhibitor for a long time.

393
00:12:32,880 --> 00:12:37,440
So, we thought this was really neat. Um

394
00:12:35,680 --> 00:12:39,760
the in the rheumatoid arthritis data

395
00:12:37,440 --> 00:12:41,200
set, our goal was to take this, you

396
00:12:39,760 --> 00:12:42,399
know, imuninohistochemistry, which is a

397
00:12:41,200 --> 00:12:44,639
relatively simple modality. It's been

398
00:12:42,399 --> 00:12:46,160
around for decades and to see whether

399
00:12:44,639 --> 00:12:48,880
our method could rediscover known

400
00:12:46,160 --> 00:12:50,480
disease subtypes that have only um that

401
00:12:48,880 --> 00:12:51,839
were only determined recently using much

402
00:12:50,480 --> 00:12:53,680
more advanced single cell type

403
00:12:51,839 --> 00:12:55,200
technologies and then to leverage the

404
00:12:53,680 --> 00:12:56,480
fact that this is a spatial modality to

405
00:12:55,200 --> 00:12:57,480
see if there was any extra insight that

406
00:12:56,480 --> 00:13:00,800
we could

407
00:12:57,480 --> 00:13:02,800
add. So we did see that Vimma found a

408
00:13:00,800 --> 00:13:04,560
very strong uh spatial signature of a

409
00:13:02,800 --> 00:13:06,800
known subtyping of rheumatoid arthritis

410
00:13:04,560 --> 00:13:08,720
into two disease subtypes. a stromal

411
00:13:06,800 --> 00:13:10,800
subtype uh in which fibroblast activity

412
00:13:08,720 --> 00:13:12,800
is high and an immune subtype uh in

413
00:13:10,800 --> 00:13:14,240
which T- cell activity is high and I

414
00:13:12,800 --> 00:13:15,279
won't go into the details but Vimma

415
00:13:14,240 --> 00:13:17,680
found this signal actually in an

416
00:13:15,279 --> 00:13:20,320
unsupervised way using um essentially a

417
00:13:17,680 --> 00:13:21,600
type of PCA applied to the sample level

418
00:13:20,320 --> 00:13:23,920
representation that it builds using

419
00:13:21,600 --> 00:13:25,519
micronese abundances and so in a sense

420
00:13:23,920 --> 00:13:28,880
what this is telling us is that Vimma

421
00:13:25,519 --> 00:13:31,440
was able to sort of rediscover um a

422
00:13:28,880 --> 00:13:32,800
known signal in this data set uh but to

423
00:13:31,440 --> 00:13:34,240
do it from a modality that's been around

424
00:13:32,800 --> 00:13:35,760
for many many years and that's much

425
00:13:34,240 --> 00:13:38,079
simpler than the single cell modalities

426
00:13:35,760 --> 00:13:39,519
that were used to actually you know um

427
00:13:38,079 --> 00:13:42,240
uncover this distinction for the first

428
00:13:39,519 --> 00:13:43,760
time. Uh and the neat thing is that

429
00:13:42,240 --> 00:13:45,279
because this is a spatial modality we

430
00:13:43,760 --> 00:13:48,480
can actually look at heterogeneity

431
00:13:45,279 --> 00:13:50,639
within samples. And what um what's neat

432
00:13:48,480 --> 00:13:52,639
about this is that Vimma actually showed

433
00:13:50,639 --> 00:13:54,399
that although there are samples in the

434
00:13:52,639 --> 00:13:55,920
data set that are composed entirely of

435
00:13:54,399 --> 00:13:57,440
immune type patches, that's the sample

436
00:13:55,920 --> 00:13:58,880
here on the left. And there are samples

437
00:13:57,440 --> 00:14:00,639
in the data set that are confused

438
00:13:58,880 --> 00:14:02,800
composed entirely of strromal type

439
00:14:00,639 --> 00:14:05,440
patches. That's the red the example on

440
00:14:02,800 --> 00:14:07,120
the right. There are also many samples

441
00:14:05,440 --> 00:14:08,720
that are mixed that have some strromal

442
00:14:07,120 --> 00:14:10,639
patches and some immune patches

443
00:14:08,720 --> 00:14:12,800
coexisting in the same person and

444
00:14:10,639 --> 00:14:15,440
actually the same joint. And because

445
00:14:12,800 --> 00:14:17,760
this um subenotyping of stromal versus

446
00:14:15,440 --> 00:14:19,040
immune is thought to actually uh predict

447
00:14:17,760 --> 00:14:20,800
be be predictive of treatment response

448
00:14:19,040 --> 00:14:22,320
in rheumatoid arthritis. These results

449
00:14:20,800 --> 00:14:23,600
have real implications for how we think

450
00:14:22,320 --> 00:14:25,600
about precision medicine in this

451
00:14:23,600 --> 00:14:28,079
disease. like does one patient really

452
00:14:25,600 --> 00:14:29,440
have one sub phenotype of RA or could

453
00:14:28,079 --> 00:14:30,959
there be multiple types of biology

454
00:14:29,440 --> 00:14:32,880
happening even within a single joint of

455
00:14:30,959 --> 00:14:34,480
a single person which is obviously not

456
00:14:32,880 --> 00:14:35,839
great news for precision medicine but

457
00:14:34,480 --> 00:14:38,800
it's important to know if that's what's

458
00:14:35,839 --> 00:14:40,639
going on. So what I hope I've shown you

459
00:14:38,800 --> 00:14:43,199
today is that uh statistical case

460
00:14:40,639 --> 00:14:45,279
control analysis in spatial data is um

461
00:14:43,199 --> 00:14:46,800
really a bit of a different problem that

462
00:14:45,279 --> 00:14:47,920
has different requirements than some of

463
00:14:46,800 --> 00:14:49,600
the other things that we're talking

464
00:14:47,920 --> 00:14:50,959
about in the spatial realm. If you want

465
00:14:49,600 --> 00:14:52,399
to do this, you really need a

466
00:14:50,959 --> 00:14:54,399
representation of spatial units that

467
00:14:52,399 --> 00:14:56,000
gives you consistent semantics across

468
00:14:54,399 --> 00:14:57,760
samples. And you need a flexible

469
00:14:56,000 --> 00:15:00,240
association testing strategy that can

470
00:14:57,760 --> 00:15:01,680
represent samples in a very rich way.

471
00:15:00,240 --> 00:15:03,440
Uh, and I hope I've shown you that our

472
00:15:01,680 --> 00:15:04,959
method Vimma enables powerful

473
00:15:03,440 --> 00:15:06,880
statistical case control analysis of

474
00:15:04,959 --> 00:15:08,160
spatial data and that it finds new and

475
00:15:06,880 --> 00:15:10,560
interesting signals across a range of

476
00:15:08,160 --> 00:15:12,399
data modalities. So with that, I'd like

477
00:15:10,560 --> 00:15:14,560
to thank my collaborators and especially

478
00:15:12,399 --> 00:15:15,839
Lshay Sud and Michelle Curtis. Lakshay

479
00:15:14,560 --> 00:15:17,440
was part of the benchmarking effort. I

480
00:15:15,839 --> 00:15:19,519
showed up front and led the application

481
00:15:17,440 --> 00:15:20,959
of Vimma to the ulcer colitis data set

482
00:15:19,519 --> 00:15:23,199
and he's actually here uh in the

483
00:15:20,959 --> 00:15:25,199
audience. Um as well as Michelle Curtis

484
00:15:23,199 --> 00:15:27,120
who led the application of Vimma to the

485
00:15:25,199 --> 00:15:29,600
Alzheimer's data set and Shar Chadri

486
00:15:27,120 --> 00:15:31,360
who's my research mentor. Um feel free

487
00:15:29,600 --> 00:15:33,360
to check out the preprint with this QR

488
00:15:31,360 --> 00:15:35,040
code. Uh the method is up on GitHub uh

489
00:15:33,360 --> 00:15:36,800
and we'd love any feedback on it if

490
00:15:35,040 --> 00:15:39,800
anyone chooses to use it. Thanks very

491
00:15:36,800 --> 00:15:39,800
much.

492
00:15:44,399 --> 00:15:48,680
I think we have a question in the back.

493
00:15:56,000 --> 00:16:01,920
So yeah, I only showed it uh you know

494
00:15:59,440 --> 00:16:05,440
when you do the section samples and then

495
00:16:01,920 --> 00:16:08,079
you uh you know engage in the uh using

496
00:16:05,440 --> 00:16:10,720
the orodocite

497
00:16:08,079 --> 00:16:14,839
uh why you pick the orodite instead of

498
00:16:10,720 --> 00:16:14,839
some other associ.

499
00:16:14,959 --> 00:16:19,199
Yeah. So I guess I I might be

500
00:16:17,360 --> 00:16:20,639
misunderstanding but to to clarify we

501
00:16:19,199 --> 00:16:22,560
didn't there's we didn't choose all the

502
00:16:20,639 --> 00:16:25,600
goodender sites uh when we were choosing

503
00:16:22,560 --> 00:16:27,040
what to input into the method. Um, so

504
00:16:25,600 --> 00:16:29,279
there was no there's no bias in that

505
00:16:27,040 --> 00:16:30,880
sense. Uh, I'm showing you and and what

506
00:16:29,279 --> 00:16:32,240
we did was compare the dementia

507
00:16:30,880 --> 00:16:33,440
associated patches to the other patches

508
00:16:32,240 --> 00:16:34,959
across all of the cell types that were

509
00:16:33,440 --> 00:16:36,240
annotated by the authors of the original

510
00:16:34,959 --> 00:16:37,600
study. And I'm just showing you sort of

511
00:16:36,240 --> 00:16:38,959
I just showed a subset for space

512
00:16:37,600 --> 00:16:40,800
reasons, but the alligender sites are

513
00:16:38,959 --> 00:16:43,120
the clearly um they're sort of the

514
00:16:40,800 --> 00:16:44,320
largest effect size and um and sort of

515
00:16:43,120 --> 00:16:45,519
there's a statistically significant

516
00:16:44,320 --> 00:16:46,959
difference there. So it might be that

517
00:16:45,519 --> 00:16:48,800
there's other cell types that differ as

518
00:16:46,959 --> 00:16:50,160
well and I'm not sure that I you know

519
00:16:48,800 --> 00:16:51,680
I'm the right person to really fully

520
00:16:50,160 --> 00:16:53,839
understand the biology there. You sample

521
00:16:51,680 --> 00:16:55,759
from Huntington disease or Alzheimer

522
00:16:53,839 --> 00:16:58,480
disease? No, this was Alzheimer's

523
00:16:55,759 --> 00:17:00,639
dementia. Okay. And actually you p you

524
00:16:58,480 --> 00:17:03,480
picked the right cell because uh

525
00:17:00,639 --> 00:17:05,839
actually last week you know there's a PC

526
00:17:03,480 --> 00:17:08,160
dissertation you know across the street

527
00:17:05,839 --> 00:17:11,360
you know they presented in Oracle

528
00:17:08,160 --> 00:17:15,120
dandelai you know has some dysfunction

529
00:17:11,360 --> 00:17:17,919
in Huntington disease and also uh to a

530
00:17:15,120 --> 00:17:22,039
lesser extent in Alzheimer.

531
00:17:17,919 --> 00:17:22,039
Yes. Um it's certainly

532
00:17:22,480 --> 00:17:25,280
thanks for that info. I think uh if

533
00:17:24,079 --> 00:17:26,640
maybe I'll talk to you later and see if

534
00:17:25,280 --> 00:17:30,080
there's a citation or something I can

535
00:17:26,640 --> 00:17:31,440
get for it. Yeah.

536
00:17:30,080 --> 00:17:33,350
Great. Let's thank the speaker one more

537
00:17:31,440 --> 00:17:37,090
time.

538
00:17:33,350 --> 00:17:37,090
[Applause]

